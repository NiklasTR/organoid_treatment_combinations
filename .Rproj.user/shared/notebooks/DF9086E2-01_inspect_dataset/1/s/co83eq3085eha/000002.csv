"0","##read ctg data files"
"0","ctg_data <- lapply(list.files('~/tas/data/ctg_data/', full.names=T, pattern = ""TAS""), "
"0","                   function(f) read_tsv(f, col_names=F, col_types = 'cci') %>%"
"0","                     `colnames<-`(c('screen', 'well', 'pcount'))) %>% bind_rows() %>%"
"0","  separate(screen, c(""date"", ""operator"", ""mithras"", ""experiment_id""), sep = ""_"", remove = FALSE) %>%"
"0","  separate(experiment_id, c(""experiment"", ""line"", ""TAS_concentration"")) %>%"
"0","  #join compound annotation data"
"0","  full_join(., lapply(list.files('~/tas/data/annotations/', full.names=T), "
"0","                   function(f) read_csv(f)) %>% bind_rows() %>%"
"0","  rename(well = destination.well) %>%"
"0","  select(drug, well, Source_Position, Source) %>%"
"0","  separate(well, c(""row"", ""col""), sep = 1, remove = FALSE) %>%"
"0","  mutate(drug = if_else(is.na(drug), Source, drug),"
"0","         drug = if_else(well == ""J19"", ""DMSO"", drug),"
"0","         combination = if_else(col == ""13"", FALSE, TRUE))) %>%"
"0","  unite(id, c(""date"", ""line"", ""TAS_concentration"", ""experiment""), remove = FALSE) %>%"
"0","  mutate(row_num = match(row, LETTERS[1:26]),"
"0","         col_num = as.numeric(col)) %>%"
"0","  #annotate concentrations"
"0","  mutate(concentration = ifelse(Source_Position == ""Rack"", NA,"
"0","                                ifelse(Source_Position == ""Master_Library_Plate"", 1,"
"0","                                       ifelse(Source_Position == ""Dilution_Plate_1"", 2,"
"0","                                              ifelse(Source_Position == ""Dilution_Plate_2"", 3,"
"0","                                                     ifelse(Source_Position == ""Dilution_Plate_3"", 4,"
"0","                                                            ifelse(Source_Position == ""Dilution_Plate_4"", 5, ""no match"")))))))"
