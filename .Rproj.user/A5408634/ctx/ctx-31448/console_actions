{
    "data" : [
        "      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    2    6      CD       C       D\n4    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    3    2      CD       C       D\n5    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    2    3      CD       C       D\n6    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12",
        "   2018-03-13         1   CTG    2    2      AB       A       B\n7    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    6    6      EF       E       F\n8    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    3    2      AB       A       B\n9    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG <NA> <NA>    <NA>    <NA>    <NA>",
        "\n10   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG <NA> <NA>    <NA>    <NA>    <NA>\n11   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG <NA> <NA>    <NA>    <NA>    <NA>\n12   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    4    4      CD       C       D\n13   180320       JB      M3      HCO D007T01V036L12        51",
        "  D007   T01  V036     L12   2018-03-13         1   CTG <NA> <NA>    <NA>    <NA>    <NA>\n14   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    3    6      AB       A       B\n15   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    4    4      AB       A       B\n16   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    1",
        "    6      EF       E       F\n17   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG <NA> <NA>    <NA>    <NA>    <NA>\n18   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    5    3      AB       A       B\n19   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    3    3      CD       C       D\n20   180320       JB      M3",
        "      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    6    4      CD       C       D\n21   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    2    4      AB       A       B\n22   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    5    6      AB       A       B\n23   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12",
        "   2018-03-13         1   CTG    4    5      CD       C       D\n24   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    5    6      EF       E       F\n25   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    3    1      CD       C       D\n26   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    5    5      AB       A       B",
        "\n27   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG <NA> <NA>    <NA>    <NA>    <NA>\n28   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    4    2      AB       A       B\n29   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG    6    4      EF       E       F\n30   180320       JB      M3      HCO D007T01V036L12        51",
        "  D007   T01  V036     L12   2018-03-13         1   CTG <NA> <NA>    <NA>    <NA>    <NA>\n     row col          drug combination    line neg_control_median\n1      A  01          <NA>        TRUE D007T01                 NA\n2      A  02          <NA>        TRUE D007T01                 NA\n3      A  03          <NA>        TRUE D007T01                 NA\n4      A  04          <NA>        TRUE D007T01                 NA\n5      A  05          <NA>        TRUE D007T01                 NA\n6      A  06          <NA>",
        "        TRUE D007T01                 NA\n7      A  07          <NA>        TRUE D007T01                 NA\n8      A  08          <NA>        TRUE D007T01                 NA\n9      A  09 Staurosporine       FALSE D007T01                 NA\n10     A  10          DMSO       FALSE D007T01           497283.8\n11     A  11          DMSO       FALSE D007T01           497283.8\n12     A  12          <NA>        TRUE D007T01                 NA\n13     A  13          DMSO       FALSE D007T01           497283.8\n14     A  14",
        "          <NA>        TRUE D007T01                 NA\n15     A  15          <NA>        TRUE D007T01                 NA\n16     A  16          <NA>        TRUE D007T01                 NA\n17     A  17          DMSO       FALSE D007T01           497283.8\n18     A  18          <NA>        TRUE D007T01                 NA\n19     A  19          <NA>        TRUE D007T01                 NA\n20     A  20          <NA>        TRUE D007T01                 NA\n21     A  21          <NA>        TRUE D007T01                 NA",
        "\n22     A  22          <NA>        TRUE D007T01                 NA\n23     A  23          <NA>        TRUE D007T01                 NA\n24     A  24          <NA>        TRUE D007T01                 NA\n25     B  01          <NA>        TRUE D007T01                 NA\n26     B  02          <NA>        TRUE D007T01                 NA\n27     B  03          DMSO       FALSE D007T01           497283.8\n28     B  04          <NA>        TRUE D007T01                 NA\n29     B  05          <NA>        TRUE D007T01                 NA",
        "\n30     B  06 Staurosporine       FALSE D007T01                 NA\n [ reached getOption(\"max.print\") -- omitted 1506 rows ]\n",
        "> ",
        "ctg_loess %>% ",
        "+ ",
        "  dplyr::select(id, drug, pcount_norm)",
        "                                    id          drug pcount_norm\n1    180320_D007T01_L12_D007T01V036L12          <NA> 321318.9590\n2    180320_D007T01_L12_D007T01V036L12          <NA> 336947.0495\n3    180320_D007T01_L12_D007T01V036L12          <NA> 498534.4117\n4    180320_D007T01_L12_D007T01V036L12          <NA> 490578.2629\n5    180320_D007T01_L12_D007T01V036L12          <NA> 453095.8203\n6    180320_D007T01_L12_D007T01V036L12          <NA> 187774.3013\n7    180320_D007T01_L12_D007T01V036L12          <NA> 553186.9895",
        "\n8    180320_D007T01_L12_D007T01V036L12          <NA> 239172.5592\n9    180320_D007T01_L12_D007T01V036L12 Staurosporine  42806.3138\n10   180320_D007T01_L12_D007T01V036L12          DMSO 531813.5569\n11   180320_D007T01_L12_D007T01V036L12          DMSO 537069.5920\n12   180320_D007T01_L12_D007T01V036L12          <NA> 527139.7225\n13   180320_D007T01_L12_D007T01V036L12          DMSO 500681.1774\n14   180320_D007T01_L12_D007T01V036L12          <NA> 209572.0665\n15   180320_D007T01_L12_D007T01V036L12          <NA> 227454.0153",
        "\n16   180320_D007T01_L12_D007T01V036L12          <NA> 368248.6489\n17   180320_D007T01_L12_D007T01V036L12          DMSO 607357.5927\n18   180320_D007T01_L12_D007T01V036L12          <NA> 307612.4719\n19   180320_D007T01_L12_D007T01V036L12          <NA> 481016.3112\n20   180320_D007T01_L12_D007T01V036L12          <NA> 450209.3942\n21   180320_D007T01_L12_D007T01V036L12          <NA> 183814.2348\n22   180320_D007T01_L12_D007T01V036L12          <NA> 368933.3469\n23   180320_D007T01_L12_D007T01V036L12          <NA> 529459.2444",
        "\n24   180320_D007T01_L12_D007T01V036L12          <NA> 485514.4410\n25   180320_D007T01_L12_D007T01V036L12          <NA> 454047.6758\n26   180320_D007T01_L12_D007T01V036L12          <NA> 248498.6099\n27   180320_D007T01_L12_D007T01V036L12          DMSO 518595.0371\n28   180320_D007T01_L12_D007T01V036L12          <NA> 275437.7453\n29   180320_D007T01_L12_D007T01V036L12          <NA> 536687.5224\n30   180320_D007T01_L12_D007T01V036L12 Staurosporine  45005.1564\n31   180320_D007T01_L12_D007T01V036L12          <NA> 327448.8477",
        "\n32   180320_D007T01_L12_D007T01V036L12 Staurosporine  46287.3487\n33   180320_D007T01_L12_D007T01V036L12          <NA> 200657.2751\n34   180320_D007T01_L12_D007T01V036L12          <NA> 391165.2427\n35   180320_D007T01_L12_D007T01V036L12          <NA> 197467.8672\n36   180320_D007T01_L12_D007T01V036L12          <NA> 326871.7643\n37   180320_D007T01_L12_D007T01V036L12          <NA> 209291.4380\n38   180320_D007T01_L12_D007T01V036L12          <NA> 329753.6714\n39   180320_D007T01_L12_D007T01V036L12          <NA> 218843.4994",
        "\n40   180320_D007T01_L12_D007T01V036L12          <NA> 320255.9565\n41   180320_D007T01_L12_D007T01V036L12          DMSO 506106.0775\n42   180320_D007T01_L12_D007T01V036L12          <NA> 317758.8971\n43   180320_D007T01_L12_D007T01V036L12          <NA> 356573.1170\n44   180320_D007T01_L12_D007T01V036L12          <NA> 280305.4185\n45   180320_D007T01_L12_D007T01V036L12          <NA> 358612.8051\n46   180320_D007T01_L12_D007T01V036L12          <NA> 289542.2807\n47   180320_D007T01_L12_D007T01V036L12          <NA> 415180.8488",
        "\n48   180320_D007T01_L12_D007T01V036L12          <NA> 331715.5132\n49   180320_D007T01_L12_D007T01V036L12          <NA> 276647.9296\n50   180320_D007T01_L12_D007T01V036L12          <NA> 229650.2314\n51   180320_D007T01_L12_D007T01V036L12          <NA> 462764.6192\n52   180320_D007T01_L12_D007T01V036L12          <NA> 353997.4594\n53   180320_D007T01_L12_D007T01V036L12          <NA> 319195.1186\n54   180320_D007T01_L12_D007T01V036L12          <NA> 509583.9635\n55   180320_D007T01_L12_D007T01V036L12          <NA> 316147.1609",
        "\n56   180320_D007T01_L12_D007T01V036L12          <NA> 450750.6496\n57   180320_D007T01_L12_D007T01V036L12          DMSO 490844.9546\n58   180320_D007T01_L12_D007T01V036L12          <NA> 449440.6006\n59   180320_D007T01_L12_D007T01V036L12          <NA> 312198.1125\n60   180320_D007T01_L12_D007T01V036L12          <NA> 461468.0150\n61   180320_D007T01_L12_D007T01V036L12          <NA> 455444.6070\n62   180320_D007T01_L12_D007T01V036L12          <NA> 470074.0414\n63   180320_D007T01_L12_D007T01V036L12          <NA> 497949.6238",
        "\n64   180320_D007T01_L12_D007T01V036L12          DMSO 532654.6603\n65   180320_D007T01_L12_D007T01V036L12          <NA> 371452.4566\n66   180320_D007T01_L12_D007T01V036L12          <NA> 309416.3186\n67   180320_D007T01_L12_D007T01V036L12          <NA> 327881.5607\n68   180320_D007T01_L12_D007T01V036L12          <NA> 310773.9910\n69   180320_D007T01_L12_D007T01V036L12          <NA> 474142.6556\n70   180320_D007T01_L12_D007T01V036L12          <NA> 187296.6006\n71   180320_D007T01_L12_D007T01V036L12          <NA> 416924.8722",
        "\n72   180320_D007T01_L12_D007T01V036L12 Staurosporine  21546.5165\n73   180320_D007T01_L12_D007T01V036L12          <NA> 312604.6634\n74   180320_D007T01_L12_D007T01V036L12          <NA> 485841.0417\n75   180320_D007T01_L12_D007T01V036L12          <NA> 209116.0202\n76   180320_D007T01_L12_D007T01V036L12          <NA> 218931.4702\n77   180320_D007T01_L12_D007T01V036L12          <NA> 299969.2631\n78   180320_D007T01_L12_D007T01V036L12          <NA> 326011.2700\n79   180320_D007T01_L12_D007T01V036L12          <NA> 546745.5477",
        "\n80   180320_D007T01_L12_D007T01V036L12          DMSO 495086.2009\n81   180320_D007T01_L12_D007T01V036L12          <NA> 437554.1730\n82   180320_D007T01_L12_D007T01V036L12 Staurosporine  56620.4074\n83   180320_D007T01_L12_D007T01V036L12          <NA> 478665.8476\n84   180320_D007T01_L12_D007T01V036L12          <NA> 320051.4370\n85   180320_D007T01_L12_D007T01V036L12          <NA> 339553.1174\n86   180320_D007T01_L12_D007T01V036L12          <NA> 228198.9117\n87   180320_D007T01_L12_D007T01V036L12          <NA> 472942.8847",
        "\n88   180320_D007T01_L12_D007T01V036L12          <NA> 355849.1009\n89   180320_D007T01_L12_D007T01V036L12          <NA> 268771.6253\n90   180320_D007T01_L12_D007T01V036L12          <NA> 321944.5225\n91   180320_D007T01_L12_D007T01V036L12          <NA> 506889.4480\n92   180320_D007T01_L12_D007T01V036L12          <NA> 192185.4078\n93   180320_D007T01_L12_D007T01V036L12          <NA> 180372.4922\n94   180320_D007T01_L12_D007T01V036L12          <NA> 204110.7914\n95   180320_D007T01_L12_D007T01V036L12          <NA> 457970.3957",
        "\n96   180320_D007T01_L12_D007T01V036L12          <NA> 311511.3954\n97   180320_D007T01_L12_D007T01V036L12          <NA> 292862.8205\n98   180320_D007T01_L12_D007T01V036L12          <NA> 408840.1681\n99   180320_D007T01_L12_D007T01V036L12          DMSO 441512.1023\n100  180320_D007T01_L12_D007T01V036L12          <NA> 436033.8430\n101  180320_D007T01_L12_D007T01V036L12          <NA> 317540.6100\n102  180320_D007T01_L12_D007T01V036L12 Staurosporine  43927.6230\n103  180320_D007T01_L12_D007T01V036L12          <NA> 215187.6266",
        "\n104  180320_D007T01_L12_D007T01V036L12          <NA> 454537.7412\n105  180320_D007T01_L12_D007T01V036L12          <NA> 444029.7510\n106  180320_D007T01_L12_D007T01V036L12          <NA> 495225.4401\n107  180320_D007T01_L12_D007T01V036L12          <NA> 264826.5926\n108  180320_D007T01_L12_D007T01V036L12          <NA> 204724.9927\n109  180320_D007T01_L12_D007T01V036L12 Staurosporine  48759.4020\n110  180320_D007T01_L12_D007T01V036L12          <NA> 511274.0179\n111  180320_D007T01_L12_D007T01V036L12          <NA> 222183.7777",
        "\n112  180320_D007T01_L12_D007T01V036L12          <NA> 529643.6188\n113  180320_D007T01_L12_D007T01V036L12          DMSO 509238.4786\n114  180320_D007T01_L12_D007T01V036L12          DMSO 458433.2946\n115  180320_D007T01_L12_D007T01V036L12          <NA> 491734.5846\n116  180320_D007T01_L12_D007T01V036L12          <NA> 494589.9649\n117  180320_D007T01_L12_D007T01V036L12          <NA> 191721.0208\n118  180320_D007T01_L12_D007T01V036L12          <NA> 294639.3376\n119  180320_D007T01_L12_D007T01V036L12          <NA> 301836.5003",
        "\n120  180320_D007T01_L12_D007T01V036L12          <NA> 355244.0942\n121  180320_D007T01_L12_D007T01V036L12          <NA> 316327.3440\n122  180320_D007T01_L12_D007T01V036L12          <NA> 494816.7383\n123  180320_D007T01_L12_D007T01V036L12 Staurosporine  43385.7279\n124  180320_D007T01_L12_D007T01V036L12          <NA> 481278.6429\n125  180320_D007T01_L12_D007T01V036L12          <NA> 211319.8135\n126  180320_D007T01_L12_D007T01V036L12          <NA> 477403.5699\n127  180320_D007T01_L12_D007T01V036L12          <NA> 350717.0162",
        "\n128  180320_D007T01_L12_D007T01V036L12          <NA> 320789.0095\n129  180320_D007T01_L12_D007T01V036L12          DMSO 506536.5094\n130  180320_D007T01_L12_D007T01V036L12          <NA> 426736.4754\n131  180320_D007T01_L12_D007T01V036L12          <NA> 212375.8672\n132  180320_D007T01_L12_D007T01V036L12          <NA> 453811.6444\n133  180320_D007T01_L12_D007T01V036L12          <NA> 210815.8936\n134  180320_D007T01_L12_D007T01V036L12          <NA> 200145.0951\n135  180320_D007T01_L12_D007T01V036L12          <NA> 358042.7988",
        "\n136  180320_D007T01_L12_D007T01V036L12 Staurosporine  30522.5544\n137  180320_D007T01_L12_D007T01V036L12          <NA> 464957.9119\n138  180320_D007T01_L12_D007T01V036L12          <NA> 314782.4211\n139  180320_D007T01_L12_D007T01V036L12          <NA> 462224.7763\n140  180320_D007T01_L12_D007T01V036L12          <NA> 463187.9584\n141  180320_D007T01_L12_D007T01V036L12          <NA> 308946.9475\n142  180320_D007T01_L12_D007T01V036L12          <NA> 460686.7237\n143  180320_D007T01_L12_D007T01V036L12          <NA> 462602.2670",
        "\n144  180320_D007T01_L12_D007T01V036L12          <NA> 495898.5574\n145  180320_D007T01_L12_D007T01V036L12          <NA> 158223.1768\n146  180320_D007T01_L12_D007T01V036L12          <NA> 475059.8797\n147  180320_D007T01_L12_D007T01V036L12          <NA> 393789.7591\n148  180320_D007T01_L12_D007T01V036L12          <NA> 482199.9350\n149  180320_D007T01_L12_D007T01V036L12          DMSO 493737.5278\n150  180320_D007T01_L12_D007T01V036L12          <NA> 301529.6578\n151  180320_D007T01_L12_D007T01V036L12          <NA> 347817.3350",
        "\n152  180320_D007T01_L12_D007T01V036L12          DMSO 474693.7446\n153  180320_D007T01_L12_D007T01V036L12          DMSO 499249.2689\n154  180320_D007T01_L12_D007T01V036L12          <NA> 319944.2904\n155  180320_D007T01_L12_D007T01V036L12          <NA> 339299.1915\n156  180320_D007T01_L12_D007T01V036L12 Staurosporine  47794.3546\n157  180320_D007T01_L12_D007T01V036L12          <NA> 485255.0252\n158  180320_D007T01_L12_D007T01V036L12 Staurosporine  36777.8789\n159  180320_D007T01_L12_D007T01V036L12          <NA> 444590.4439",
        "\n160  180320_D007T01_L12_D007T01V036L12          DMSO 512760.2483\n161  180320_D007T01_L12_D007T01V036L12          <NA> 451124.8203\n162  180320_D007T01_L12_D007T01V036L12          <NA> 157661.6879\n163  180320_D007T01_L12_D007T01V036L12          <NA> 299527.8287\n164  180320_D007T01_L12_D007T01V036L12          <NA> 214689.6842\n165  180320_D007T01_L12_D007T01V036L12          <NA> 471868.9782\n166  180320_D007T01_L12_D007T01V036L12          <NA> 434847.4345\n167  180320_D007T01_L12_D007T01V036L12          <NA> 435396.7770",
        "\n168  180320_D007T01_L12_D007T01V036L12          <NA> 374518.7295\n169  180320_D007T01_L12_D007T01V036L12          <NA> 478265.2622\n170  180320_D007T01_L12_D007T01V036L12          <NA> 275698.7200\n171  180320_D007T01_L12_D007T01V036L12          <NA> 434797.0581\n172  180320_D007T01_L12_D007T01V036L12          <NA> 168191.7846\n173  180320_D007T01_L12_D007T01V036L12          DMSO 484504.4072\n174  180320_D007T01_L12_D007T01V036L12          <NA> 310676.4339\n175  180320_D007T01_L12_D007T01V036L12          <NA> 430162.2016",
        "\n176  180320_D007T01_L12_D007T01V036L12          <NA> 189725.6853\n177  180320_D007T01_L12_D007T01V036L12          <NA> 465032.8503\n178  180320_D007T01_L12_D007T01V036L12          <NA> 281159.6618\n179  180320_D007T01_L12_D007T01V036L12          <NA> 374562.0852\n180  180320_D007T01_L12_D007T01V036L12          <NA> 455716.0857\n181  180320_D007T01_L12_D007T01V036L12          <NA> 199519.2295\n182  180320_D007T01_L12_D007T01V036L12          DMSO 516858.1045\n183  180320_D007T01_L12_D007T01V036L12          <NA> 185597.2089",
        "\n184  180320_D007T01_L12_D007T01V036L12          <NA> 494261.0410\n185  180320_D007T01_L12_D007T01V036L12          <NA> 437024.0989\n186  180320_D007T01_L12_D007T01V036L12          <NA> 347090.8808\n187  180320_D007T01_L12_D007T01V036L12          <NA> 419881.5477\n188  180320_D007T01_L12_D007T01V036L12          <NA> 452095.4384\n189  180320_D007T01_L12_D007T01V036L12          <NA> 475465.8188\n190  180320_D007T01_L12_D007T01V036L12          <NA> 284465.9546\n191  180320_D007T01_L12_D007T01V036L12          <NA> 231659.1113",
        "\n192  180320_D007T01_L12_D007T01V036L12          <NA> 359928.5548\n193  180320_D007T01_L12_D007T01V036L12          <NA> 425993.4230\n194  180320_D007T01_L12_D007T01V036L12          <NA> 282294.3491\n195  180320_D007T01_L12_D007T01V036L12          <NA> 434513.5190\n196  180320_D007T01_L12_D007T01V036L12          <NA> 257414.1751\n197  180320_D007T01_L12_D007T01V036L12          <NA> 460329.5593\n198  180320_D007T01_L12_D007T01V036L12          <NA> 357682.9139\n199  180320_D007T01_L12_D007T01V036L12          <NA> 309106.2942",
        "\n200  180320_D007T01_L12_D007T01V036L12          DMSO 484612.0046\n201  180320_D007T01_L12_D007T01V036L12          <NA> 300213.6608\n202  180320_D007T01_L12_D007T01V036L12          <NA> 469604.8787\n203  180320_D007T01_L12_D007T01V036L12          <NA> 187999.2738\n204  180320_D007T01_L12_D007T01V036L12          <NA> 436660.4620\n205  180320_D007T01_L12_D007T01V036L12          <NA> 408785.8685\n206  180320_D007T01_L12_D007T01V036L12          DMSO 465264.6099\n207  180320_D007T01_L12_D007T01V036L12          <NA> 471857.8391",
        "\n208  180320_D007T01_L12_D007T01V036L12          <NA> 295086.7092\n209  180320_D007T01_L12_D007T01V036L12          <NA> 445902.3730\n210  180320_D007T01_L12_D007T01V036L12          <NA> 494165.9836\n211  180320_D007T01_L12_D007T01V036L12          <NA> 193545.0644\n212  180320_D007T01_L12_D007T01V036L12          DMSO 439905.2578\n213  180320_D007T01_L12_D007T01V036L12          <NA> 178324.8949\n214  180320_D007T01_L12_D007T01V036L12          <NA> 219022.3070\n215  180320_D007T01_L12_D007T01V036L12          <NA> 482845.8252",
        "\n216  180320_D007T01_L12_D007T01V036L12          <NA> 443053.7809\n217  180320_D007T01_L12_D007T01V036L12          <NA> 478168.2999\n218  180320_D007T01_L12_D007T01V036L12          DMSO 470475.1284\n219  180320_D007T01_L12_D007T01V036L12          <NA> 468372.1101\n220  180320_D007T01_L12_D007T01V036L12          <NA> 248905.8205\n221  180320_D007T01_L12_D007T01V036L12 Staurosporine   6192.8348\n222  180320_D007T01_L12_D007T01V036L12          <NA> 184409.7284\n223  180320_D007T01_L12_D007T01V036L12          <NA> 307691.8710",
        "\n224  180320_D007T01_L12_D007T01V036L12          <NA> 263788.1250\n225  180320_D007T01_L12_D007T01V036L12          <NA> 455625.3045\n226  180320_D007T01_L12_D007T01V036L12          <NA> 380950.2240\n227  180320_D007T01_L12_D007T01V036L12          <NA> 209349.6977\n228  180320_D007T01_L12_D007T01V036L12          <NA> 461670.5398\n229  180320_D007T01_L12_D007T01V036L12          <NA> 449533.4426\n230  180320_D007T01_L12_D007T01V036L12          DMSO 480335.2162\n231  180320_D007T01_L12_D007T01V036L12          <NA> 171051.8514",
        "\n232  180320_D007T01_L12_D007T01V036L12          <NA> 455699.3392\n233  180320_D007T01_L12_D007T01V036L12          <NA> 329193.6705\n234  180320_D007T01_L12_D007T01V036L12          <NA> 458990.8361\n235  180320_D007T01_L12_D007T01V036L12          DMSO 464163.7364\n236  180320_D007T01_L12_D007T01V036L12          <NA> 326785.8277\n237  180320_D007T01_L12_D007T01V036L12          <NA> 177053.9344\n238  180320_D007T01_L12_D007T01V036L12          <NA> 205894.8812\n239  180320_D007T01_L12_D007T01V036L12          <NA> 506075.4926",
        "\n240  180320_D007T01_L12_D007T01V036L12          <NA> 481412.5932\n241  180320_D007T01_L12_D007T01V036L12          <NA> 491376.0625\n242  180320_D007T01_L12_D007T01V036L12          <NA> 173591.0924\n243  180320_D007T01_L12_D007T01V036L12          <NA> 333556.3054\n244  180320_D007T01_L12_D007T01V036L12          <NA> 500073.8819\n245  180320_D007T01_L12_D007T01V036L12          <NA> 329256.0025\n246  180320_D007T01_L12_D007T01V036L12          <NA> 289344.8477\n247  180320_D007T01_L12_D007T01V036L12          <NA> 268033.9206",
        "\n248  180320_D007T01_L12_D007T01V036L12          <NA> 451885.1594\n249  180320_D007T01_L12_D007T01V036L12          DMSO 470668.3970\n250  180320_D007T01_L12_D007T01V036L12          <NA> 478793.4660\n251  180320_D007T01_L12_D007T01V036L12          <NA> 293720.1992\n252  180320_D007T01_L12_D007T01V036L12          <NA> 512518.4295\n253  180320_D007T01_L12_D007T01V036L12          <NA> 414946.0927\n254  180320_D007T01_L12_D007T01V036L12          <NA> 298664.1336\n255  180320_D007T01_L12_D007T01V036L12          <NA> 159136.8990",
        "\n256  180320_D007T01_L12_D007T01V036L12          <NA> 151468.7356\n257  180320_D007T01_L12_D007T01V036L12          <NA> 308293.9900\n258  180320_D007T01_L12_D007T01V036L12          <NA> 278587.0088\n259  180320_D007T01_L12_D007T01V036L12          <NA> 466369.7088\n260  180320_D007T01_L12_D007T01V036L12          <NA> 487152.4172\n261  180320_D007T01_L12_D007T01V036L12          <NA> 503362.0971\n262  180320_D007T01_L12_D007T01V036L12          <NA> 349045.7112\n263  180320_D007T01_L12_D007T01V036L12 Staurosporine  13950.2225",
        "\n264  180320_D007T01_L12_D007T01V036L12          DMSO 514142.5938\n265  180320_D007T01_L12_D007T01V036L12          <NA> 433272.8805\n266  180320_D007T01_L12_D007T01V036L12          DMSO 482022.2757\n267  180320_D007T01_L12_D007T01V036L12          <NA> 436809.5787\n268  180320_D007T01_L12_D007T01V036L12          <NA> 449195.5202\n269  180320_D007T01_L12_D007T01V036L12          <NA> 417610.8310\n270  180320_D007T01_L12_D007T01V036L12          DMSO 490726.2416\n271  180320_D007T01_L12_D007T01V036L12          <NA> 315167.4314",
        "\n272  180320_D007T01_L12_D007T01V036L12          <NA> 463634.2210\n273  180320_D007T01_L12_D007T01V036L12          <NA> 343773.5536\n274  180320_D007T01_L12_D007T01V036L12          <NA> 175862.3725\n275  180320_D007T01_L12_D007T01V036L12          <NA> 294497.6208\n276  180320_D007T01_L12_D007T01V036L12          <NA> 489206.2417\n277  180320_D007T01_L12_D007T01V036L12          <NA> 259997.9594\n278  180320_D007T01_L12_D007T01V036L12          <NA> 304275.5722\n279  180320_D007T01_L12_D007T01V036L12          DMSO 499070.6352",
        "\n280  180320_D007T01_L12_D007T01V036L12          <NA> 344344.7030\n281  180320_D007T01_L12_D007T01V036L12          <NA> 483379.3304\n282  180320_D007T01_L12_D007T01V036L12          DMSO 505136.0724\n283  180320_D007T01_L12_D007T01V036L12          <NA> 177965.1264\n284  180320_D007T01_L12_D007T01V036L12          DMSO 465750.2954\n285  180320_D007T01_L12_D007T01V036L12          <NA> 342698.5426\n286  180320_D007T01_L12_D007T01V036L12          <NA> 202056.8310\n287  180320_D007T01_L12_D007T01V036L12          <NA> 341032.1239",
        "\n288  180320_D007T01_L12_D007T01V036L12          <NA> 541031.3843\n289  180320_D007T01_L12_D007T01V036L12          <NA> 122844.9236\n290  180320_D007T01_L12_D007T01V036L12          <NA> 469558.7128\n291  180320_D007T01_L12_D007T01V036L12          <NA> 250075.4041\n292  180320_D007T01_L12_D007T01V036L12          <NA> 191987.8965\n293  180320_D007T01_L12_D007T01V036L12          <NA> 140299.0890\n294  180320_D007T01_L12_D007T01V036L12          <NA> 387361.8805\n295  180320_D007T01_L12_D007T01V036L12          <NA> 472907.3919",
        "\n296  180320_D007T01_L12_D007T01V036L12          <NA> 439696.4226\n297  180320_D007T01_L12_D007T01V036L12          <NA> 462511.3901\n298  180320_D007T01_L12_D007T01V036L12          <NA> 451104.7118\n299  180320_D007T01_L12_D007T01V036L12          <NA> 170348.8049\n300  180320_D007T01_L12_D007T01V036L12          <NA> 261656.0869\n301  180320_D007T01_L12_D007T01V036L12          <NA> 446473.1835\n302  180320_D007T01_L12_D007T01V036L12          <NA> 303383.7422\n303  180320_D007T01_L12_D007T01V036L12          <NA> 516550.7130",
        "\n304  180320_D007T01_L12_D007T01V036L12          DMSO 495497.0459\n305  180320_D007T01_L12_D007T01V036L12          <NA> 331015.6907\n306  180320_D007T01_L12_D007T01V036L12 Staurosporine   4039.5975\n307  180320_D007T01_L12_D007T01V036L12          DMSO 548372.1344\n308  180320_D007T01_L12_D007T01V036L12          DMSO 522734.7313\n309  180320_D007T01_L12_D007T01V036L12 Staurosporine  17802.4305\n310  180320_D007T01_L12_D007T01V036L12          <NA> 543060.2745\n311  180320_D007T01_L12_D007T01V036L12          <NA> 499023.3057",
        "\n312  180320_D007T01_L12_D007T01V036L12          <NA> 248626.5665\n313  180320_D007T01_L12_D007T01V036L12          <NA> 465868.3613\n314  180320_D007T01_L12_D007T01V036L12          <NA> 129000.4382\n315  180320_D007T01_L12_D007T01V036L12          <NA> 461387.2556\n316  180320_D007T01_L12_D007T01V036L12          <NA> 429948.1717\n317  180320_D007T01_L12_D007T01V036L12          <NA> 273022.5451\n318  180320_D007T01_L12_D007T01V036L12          <NA> 253069.7344\n319  180320_D007T01_L12_D007T01V036L12          <NA> 482078.7906",
        "\n320  180320_D007T01_L12_D007T01V036L12          <NA> 337062.8774\n321  180320_D007T01_L12_D007T01V036L12          <NA> 481692.5221\n322  180320_D007T01_L12_D007T01V036L12 Staurosporine -21441.7482\n323  180320_D007T01_L12_D007T01V036L12          <NA> 153650.5939\n324  180320_D007T01_L12_D007T01V036L12          <NA> 369940.0755\n325  180320_D007T01_L12_D007T01V036L12          <NA> 153185.9058\n326  180320_D007T01_L12_D007T01V036L12          DMSO 471972.8537\n327  180320_D007T01_L12_D007T01V036L12          <NA> 507024.7858",
        "\n328  180320_D007T01_L12_D007T01V036L12          <NA> 487905.5689\n329  180320_D007T01_L12_D007T01V036L12          <NA> 179079.0696\n330  180320_D007T01_L12_D007T01V036L12          <NA> 250739.1546\n331  180320_D007T01_L12_D007T01V036L12          <NA> 303752.8778\n332  180320_D007T01_L12_D007T01V036L12          <NA> 231050.9939\n333  180320_D007T01_L12_D007T01V036L12          <NA> 409362.9206\n [ reached getOption(\"max.print\") -- omitted 1203 rows ]\n",
        "> ",
        "  filter(drug == \"DMSO\") %>% group_by(id) %>% ",
        "+ ",
        "  mutate(neg_control_median = median(pcount_norm, na.rm = TRUE))",
        "Error in filter(drug == \"DMSO\") : object 'drug' not found\n",
        "> ",
        "filter(drug == \"DMSO\") %>% group_by(id) %>% ",
        "+ ",
        "  mutate(neg_control_median = median(pcount_norm, na.rm = TRUE))) %>% ",
        "Error: unexpected ')' in:\n\"filter(drug == \"DMSO\") %>% group_by(id) %>% \n  mutate(neg_control_median = median(pcount_norm, na.rm = TRUE)))\"\n",
        "> ",
        "  mutate(viability = pcount_norm/neg_control_median)",
        "Error in mutate(viability = pcount_norm/neg_control_median) : \n  object 'pcount_norm' not found\n",
        "> ",
        "ctg_loess %>% ",
        "+ ",
        "  dplyr::select(id, drug, pcount_norm)",
        "                                    id          drug pcount_norm\n1    180320_D007T01_L12_D007T01V036L12          <NA> 321318.9590\n2    180320_D007T01_L12_D007T01V036L12          <NA> 336947.0495\n3    180320_D007T01_L12_D007T01V036L12          <NA> 498534.4117\n4    180320_D007T01_L12_D007T01V036L12          <NA> 490578.2629\n5    180320_D007T01_L12_D007T01V036L12          <NA> 453095.8203\n6    180320_D007T01_L12_D007T01V036L12          <NA> 187774.3013\n7    180320_D007T01_L12_D007T01V036L12          <NA> 553186.9895",
        "\n8    180320_D007T01_L12_D007T01V036L12          <NA> 239172.5592\n9    180320_D007T01_L12_D007T01V036L12 Staurosporine  42806.3138\n10   180320_D007T01_L12_D007T01V036L12          DMSO 531813.5569\n11   180320_D007T01_L12_D007T01V036L12          DMSO 537069.5920\n12   180320_D007T01_L12_D007T01V036L12          <NA> 527139.7225\n13   180320_D007T01_L12_D007T01V036L12          DMSO 500681.1774\n14   180320_D007T01_L12_D007T01V036L12          <NA> 209572.0665\n15   180320_D007T01_L12_D007T01V036L12          <NA> 227454.0153",
        "\n16   180320_D007T01_L12_D007T01V036L12          <NA> 368248.6489\n17   180320_D007T01_L12_D007T01V036L12          DMSO 607357.5927\n18   180320_D007T01_L12_D007T01V036L12          <NA> 307612.4719\n19   180320_D007T01_L12_D007T01V036L12          <NA> 481016.3112\n20   180320_D007T01_L12_D007T01V036L12          <NA> 450209.3942\n21   180320_D007T01_L12_D007T01V036L12          <NA> 183814.2348\n22   180320_D007T01_L12_D007T01V036L12          <NA> 368933.3469\n23   180320_D007T01_L12_D007T01V036L12          <NA> 529459.2444",
        "\n24   180320_D007T01_L12_D007T01V036L12          <NA> 485514.4410\n25   180320_D007T01_L12_D007T01V036L12          <NA> 454047.6758\n26   180320_D007T01_L12_D007T01V036L12          <NA> 248498.6099\n27   180320_D007T01_L12_D007T01V036L12          DMSO 518595.0371\n28   180320_D007T01_L12_D007T01V036L12          <NA> 275437.7453\n29   180320_D007T01_L12_D007T01V036L12          <NA> 536687.5224\n30   180320_D007T01_L12_D007T01V036L12 Staurosporine  45005.1564\n31   180320_D007T01_L12_D007T01V036L12          <NA> 327448.8477",
        "\n32   180320_D007T01_L12_D007T01V036L12 Staurosporine  46287.3487\n33   180320_D007T01_L12_D007T01V036L12          <NA> 200657.2751\n34   180320_D007T01_L12_D007T01V036L12          <NA> 391165.2427\n35   180320_D007T01_L12_D007T01V036L12          <NA> 197467.8672\n36   180320_D007T01_L12_D007T01V036L12          <NA> 326871.7643\n37   180320_D007T01_L12_D007T01V036L12          <NA> 209291.4380\n38   180320_D007T01_L12_D007T01V036L12          <NA> 329753.6714\n39   180320_D007T01_L12_D007T01V036L12          <NA> 218843.4994",
        "\n40   180320_D007T01_L12_D007T01V036L12          <NA> 320255.9565\n41   180320_D007T01_L12_D007T01V036L12          DMSO 506106.0775\n42   180320_D007T01_L12_D007T01V036L12          <NA> 317758.8971\n43   180320_D007T01_L12_D007T01V036L12          <NA> 356573.1170\n44   180320_D007T01_L12_D007T01V036L12          <NA> 280305.4185\n45   180320_D007T01_L12_D007T01V036L12          <NA> 358612.8051\n46   180320_D007T01_L12_D007T01V036L12          <NA> 289542.2807\n47   180320_D007T01_L12_D007T01V036L12          <NA> 415180.8488",
        "\n48   180320_D007T01_L12_D007T01V036L12          <NA> 331715.5132\n49   180320_D007T01_L12_D007T01V036L12          <NA> 276647.9296\n50   180320_D007T01_L12_D007T01V036L12          <NA> 229650.2314\n51   180320_D007T01_L12_D007T01V036L12          <NA> 462764.6192\n52   180320_D007T01_L12_D007T01V036L12          <NA> 353997.4594\n53   180320_D007T01_L12_D007T01V036L12          <NA> 319195.1186\n54   180320_D007T01_L12_D007T01V036L12          <NA> 509583.9635\n55   180320_D007T01_L12_D007T01V036L12          <NA> 316147.1609",
        "\n56   180320_D007T01_L12_D007T01V036L12          <NA> 450750.6496\n57   180320_D007T01_L12_D007T01V036L12          DMSO 490844.9546\n58   180320_D007T01_L12_D007T01V036L12          <NA> 449440.6006\n59   180320_D007T01_L12_D007T01V036L12          <NA> 312198.1125\n60   180320_D007T01_L12_D007T01V036L12          <NA> 461468.0150\n61   180320_D007T01_L12_D007T01V036L12          <NA> 455444.6070\n62   180320_D007T01_L12_D007T01V036L12          <NA> 470074.0414\n63   180320_D007T01_L12_D007T01V036L12          <NA> 497949.6238",
        "\n64   180320_D007T01_L12_D007T01V036L12          DMSO 532654.6603\n65   180320_D007T01_L12_D007T01V036L12          <NA> 371452.4566\n66   180320_D007T01_L12_D007T01V036L12          <NA> 309416.3186\n67   180320_D007T01_L12_D007T01V036L12          <NA> 327881.5607\n68   180320_D007T01_L12_D007T01V036L12          <NA> 310773.9910\n69   180320_D007T01_L12_D007T01V036L12          <NA> 474142.6556\n70   180320_D007T01_L12_D007T01V036L12          <NA> 187296.6006\n71   180320_D007T01_L12_D007T01V036L12          <NA> 416924.8722",
        "\n72   180320_D007T01_L12_D007T01V036L12 Staurosporine  21546.5165\n73   180320_D007T01_L12_D007T01V036L12          <NA> 312604.6634\n74   180320_D007T01_L12_D007T01V036L12          <NA> 485841.0417\n75   180320_D007T01_L12_D007T01V036L12          <NA> 209116.0202\n76   180320_D007T01_L12_D007T01V036L12          <NA> 218931.4702\n77   180320_D007T01_L12_D007T01V036L12          <NA> 299969.2631\n78   180320_D007T01_L12_D007T01V036L12          <NA> 326011.2700\n79   180320_D007T01_L12_D007T01V036L12          <NA> 546745.5477",
        "\n80   180320_D007T01_L12_D007T01V036L12          DMSO 495086.2009\n81   180320_D007T01_L12_D007T01V036L12          <NA> 437554.1730\n82   180320_D007T01_L12_D007T01V036L12 Staurosporine  56620.4074\n83   180320_D007T01_L12_D007T01V036L12          <NA> 478665.8476\n84   180320_D007T01_L12_D007T01V036L12          <NA> 320051.4370\n85   180320_D007T01_L12_D007T01V036L12          <NA> 339553.1174\n86   180320_D007T01_L12_D007T01V036L12          <NA> 228198.9117\n87   180320_D007T01_L12_D007T01V036L12          <NA> 472942.8847",
        "\n88   180320_D007T01_L12_D007T01V036L12          <NA> 355849.1009\n89   180320_D007T01_L12_D007T01V036L12          <NA> 268771.6253\n90   180320_D007T01_L12_D007T01V036L12          <NA> 321944.5225\n91   180320_D007T01_L12_D007T01V036L12          <NA> 506889.4480\n92   180320_D007T01_L12_D007T01V036L12          <NA> 192185.4078\n93   180320_D007T01_L12_D007T01V036L12          <NA> 180372.4922\n94   180320_D007T01_L12_D007T01V036L12          <NA> 204110.7914\n95   180320_D007T01_L12_D007T01V036L12          <NA> 457970.3957",
        "\n96   180320_D007T01_L12_D007T01V036L12          <NA> 311511.3954\n97   180320_D007T01_L12_D007T01V036L12          <NA> 292862.8205\n98   180320_D007T01_L12_D007T01V036L12          <NA> 408840.1681\n99   180320_D007T01_L12_D007T01V036L12          DMSO 441512.1023\n100  180320_D007T01_L12_D007T01V036L12          <NA> 436033.8430\n101  180320_D007T01_L12_D007T01V036L12          <NA> 317540.6100\n102  180320_D007T01_L12_D007T01V036L12 Staurosporine  43927.6230\n103  180320_D007T01_L12_D007T01V036L12          <NA> 215187.6266",
        "\n104  180320_D007T01_L12_D007T01V036L12          <NA> 454537.7412\n105  180320_D007T01_L12_D007T01V036L12          <NA> 444029.7510\n106  180320_D007T01_L12_D007T01V036L12          <NA> 495225.4401\n107  180320_D007T01_L12_D007T01V036L12          <NA> 264826.5926\n108  180320_D007T01_L12_D007T01V036L12          <NA> 204724.9927\n109  180320_D007T01_L12_D007T01V036L12 Staurosporine  48759.4020\n110  180320_D007T01_L12_D007T01V036L12          <NA> 511274.0179\n111  180320_D007T01_L12_D007T01V036L12          <NA> 222183.7777",
        "\n112  180320_D007T01_L12_D007T01V036L12          <NA> 529643.6188\n113  180320_D007T01_L12_D007T01V036L12          DMSO 509238.4786\n114  180320_D007T01_L12_D007T01V036L12          DMSO 458433.2946\n115  180320_D007T01_L12_D007T01V036L12          <NA> 491734.5846\n116  180320_D007T01_L12_D007T01V036L12          <NA> 494589.9649\n117  180320_D007T01_L12_D007T01V036L12          <NA> 191721.0208\n118  180320_D007T01_L12_D007T01V036L12          <NA> 294639.3376\n119  180320_D007T01_L12_D007T01V036L12          <NA> 301836.5003",
        "\n120  180320_D007T01_L12_D007T01V036L12          <NA> 355244.0942\n121  180320_D007T01_L12_D007T01V036L12          <NA> 316327.3440\n122  180320_D007T01_L12_D007T01V036L12          <NA> 494816.7383\n123  180320_D007T01_L12_D007T01V036L12 Staurosporine  43385.7279\n124  180320_D007T01_L12_D007T01V036L12          <NA> 481278.6429\n125  180320_D007T01_L12_D007T01V036L12          <NA> 211319.8135\n126  180320_D007T01_L12_D007T01V036L12          <NA> 477403.5699\n127  180320_D007T01_L12_D007T01V036L12          <NA> 350717.0162",
        "\n128  180320_D007T01_L12_D007T01V036L12          <NA> 320789.0095\n129  180320_D007T01_L12_D007T01V036L12          DMSO 506536.5094\n130  180320_D007T01_L12_D007T01V036L12          <NA> 426736.4754\n131  180320_D007T01_L12_D007T01V036L12          <NA> 212375.8672\n132  180320_D007T01_L12_D007T01V036L12          <NA> 453811.6444\n133  180320_D007T01_L12_D007T01V036L12          <NA> 210815.8936\n134  180320_D007T01_L12_D007T01V036L12          <NA> 200145.0951\n135  180320_D007T01_L12_D007T01V036L12          <NA> 358042.7988",
        "\n136  180320_D007T01_L12_D007T01V036L12 Staurosporine  30522.5544\n137  180320_D007T01_L12_D007T01V036L12          <NA> 464957.9119\n138  180320_D007T01_L12_D007T01V036L12          <NA> 314782.4211\n139  180320_D007T01_L12_D007T01V036L12          <NA> 462224.7763\n140  180320_D007T01_L12_D007T01V036L12          <NA> 463187.9584\n141  180320_D007T01_L12_D007T01V036L12          <NA> 308946.9475\n142  180320_D007T01_L12_D007T01V036L12          <NA> 460686.7237\n143  180320_D007T01_L12_D007T01V036L12          <NA> 462602.2670",
        "\n144  180320_D007T01_L12_D007T01V036L12          <NA> 495898.5574\n145  180320_D007T01_L12_D007T01V036L12          <NA> 158223.1768\n146  180320_D007T01_L12_D007T01V036L12          <NA> 475059.8797\n147  180320_D007T01_L12_D007T01V036L12          <NA> 393789.7591\n148  180320_D007T01_L12_D007T01V036L12          <NA> 482199.9350\n149  180320_D007T01_L12_D007T01V036L12          DMSO 493737.5278\n150  180320_D007T01_L12_D007T01V036L12          <NA> 301529.6578\n151  180320_D007T01_L12_D007T01V036L12          <NA> 347817.3350",
        "\n152  180320_D007T01_L12_D007T01V036L12          DMSO 474693.7446\n153  180320_D007T01_L12_D007T01V036L12          DMSO 499249.2689\n154  180320_D007T01_L12_D007T01V036L12          <NA> 319944.2904\n155  180320_D007T01_L12_D007T01V036L12          <NA> 339299.1915\n156  180320_D007T01_L12_D007T01V036L12 Staurosporine  47794.3546\n157  180320_D007T01_L12_D007T01V036L12          <NA> 485255.0252\n158  180320_D007T01_L12_D007T01V036L12 Staurosporine  36777.8789\n159  180320_D007T01_L12_D007T01V036L12          <NA> 444590.4439",
        "\n160  180320_D007T01_L12_D007T01V036L12          DMSO 512760.2483\n161  180320_D007T01_L12_D007T01V036L12          <NA> 451124.8203\n162  180320_D007T01_L12_D007T01V036L12          <NA> 157661.6879\n163  180320_D007T01_L12_D007T01V036L12          <NA> 299527.8287\n164  180320_D007T01_L12_D007T01V036L12          <NA> 214689.6842\n165  180320_D007T01_L12_D007T01V036L12          <NA> 471868.9782\n166  180320_D007T01_L12_D007T01V036L12          <NA> 434847.4345\n167  180320_D007T01_L12_D007T01V036L12          <NA> 435396.7770",
        "\n168  180320_D007T01_L12_D007T01V036L12          <NA> 374518.7295\n169  180320_D007T01_L12_D007T01V036L12          <NA> 478265.2622\n170  180320_D007T01_L12_D007T01V036L12          <NA> 275698.7200\n171  180320_D007T01_L12_D007T01V036L12          <NA> 434797.0581\n172  180320_D007T01_L12_D007T01V036L12          <NA> 168191.7846\n173  180320_D007T01_L12_D007T01V036L12          DMSO 484504.4072\n174  180320_D007T01_L12_D007T01V036L12          <NA> 310676.4339\n175  180320_D007T01_L12_D007T01V036L12          <NA> 430162.2016",
        "\n176  180320_D007T01_L12_D007T01V036L12          <NA> 189725.6853\n177  180320_D007T01_L12_D007T01V036L12          <NA> 465032.8503\n178  180320_D007T01_L12_D007T01V036L12          <NA> 281159.6618\n179  180320_D007T01_L12_D007T01V036L12          <NA> 374562.0852\n180  180320_D007T01_L12_D007T01V036L12          <NA> 455716.0857\n181  180320_D007T01_L12_D007T01V036L12          <NA> 199519.2295\n182  180320_D007T01_L12_D007T01V036L12          DMSO 516858.1045\n183  180320_D007T01_L12_D007T01V036L12          <NA> 185597.2089",
        "\n184  180320_D007T01_L12_D007T01V036L12          <NA> 494261.0410\n185  180320_D007T01_L12_D007T01V036L12          <NA> 437024.0989\n186  180320_D007T01_L12_D007T01V036L12          <NA> 347090.8808\n187  180320_D007T01_L12_D007T01V036L12          <NA> 419881.5477\n188  180320_D007T01_L12_D007T01V036L12          <NA> 452095.4384\n189  180320_D007T01_L12_D007T01V036L12          <NA> 475465.8188\n190  180320_D007T01_L12_D007T01V036L12          <NA> 284465.9546\n191  180320_D007T01_L12_D007T01V036L12          <NA> 231659.1113",
        "\n192  180320_D007T01_L12_D007T01V036L12          <NA> 359928.5548\n193  180320_D007T01_L12_D007T01V036L12          <NA> 425993.4230\n194  180320_D007T01_L12_D007T01V036L12          <NA> 282294.3491\n195  180320_D007T01_L12_D007T01V036L12          <NA> 434513.5190\n196  180320_D007T01_L12_D007T01V036L12          <NA> 257414.1751\n197  180320_D007T01_L12_D007T01V036L12          <NA> 460329.5593\n198  180320_D007T01_L12_D007T01V036L12          <NA> 357682.9139\n199  180320_D007T01_L12_D007T01V036L12          <NA> 309106.2942",
        "\n200  180320_D007T01_L12_D007T01V036L12          DMSO 484612.0046\n201  180320_D007T01_L12_D007T01V036L12          <NA> 300213.6608\n202  180320_D007T01_L12_D007T01V036L12          <NA> 469604.8787\n203  180320_D007T01_L12_D007T01V036L12          <NA> 187999.2738\n204  180320_D007T01_L12_D007T01V036L12          <NA> 436660.4620\n205  180320_D007T01_L12_D007T01V036L12          <NA> 408785.8685\n206  180320_D007T01_L12_D007T01V036L12          DMSO 465264.6099\n207  180320_D007T01_L12_D007T01V036L12          <NA> 471857.8391",
        "\n208  180320_D007T01_L12_D007T01V036L12          <NA> 295086.7092\n209  180320_D007T01_L12_D007T01V036L12          <NA> 445902.3730\n210  180320_D007T01_L12_D007T01V036L12          <NA> 494165.9836\n211  180320_D007T01_L12_D007T01V036L12          <NA> 193545.0644\n212  180320_D007T01_L12_D007T01V036L12          DMSO 439905.2578\n213  180320_D007T01_L12_D007T01V036L12          <NA> 178324.8949\n214  180320_D007T01_L12_D007T01V036L12          <NA> 219022.3070\n215  180320_D007T01_L12_D007T01V036L12          <NA> 482845.8252",
        "\n216  180320_D007T01_L12_D007T01V036L12          <NA> 443053.7809\n217  180320_D007T01_L12_D007T01V036L12          <NA> 478168.2999\n218  180320_D007T01_L12_D007T01V036L12          DMSO 470475.1284\n219  180320_D007T01_L12_D007T01V036L12          <NA> 468372.1101\n220  180320_D007T01_L12_D007T01V036L12          <NA> 248905.8205\n221  180320_D007T01_L12_D007T01V036L12 Staurosporine   6192.8348\n222  180320_D007T01_L12_D007T01V036L12          <NA> 184409.7284\n223  180320_D007T01_L12_D007T01V036L12          <NA> 307691.8710",
        "\n224  180320_D007T01_L12_D007T01V036L12          <NA> 263788.1250\n225  180320_D007T01_L12_D007T01V036L12          <NA> 455625.3045\n226  180320_D007T01_L12_D007T01V036L12          <NA> 380950.2240\n227  180320_D007T01_L12_D007T01V036L12          <NA> 209349.6977\n228  180320_D007T01_L12_D007T01V036L12          <NA> 461670.5398\n229  180320_D007T01_L12_D007T01V036L12          <NA> 449533.4426\n230  180320_D007T01_L12_D007T01V036L12          DMSO 480335.2162\n231  180320_D007T01_L12_D007T01V036L12          <NA> 171051.8514",
        "\n232  180320_D007T01_L12_D007T01V036L12          <NA> 455699.3392\n233  180320_D007T01_L12_D007T01V036L12          <NA> 329193.6705\n234  180320_D007T01_L12_D007T01V036L12          <NA> 458990.8361\n235  180320_D007T01_L12_D007T01V036L12          DMSO 464163.7364\n236  180320_D007T01_L12_D007T01V036L12          <NA> 326785.8277\n237  180320_D007T01_L12_D007T01V036L12          <NA> 177053.9344\n238  180320_D007T01_L12_D007T01V036L12          <NA> 205894.8812\n239  180320_D007T01_L12_D007T01V036L12          <NA> 506075.4926",
        "\n240  180320_D007T01_L12_D007T01V036L12          <NA> 481412.5932\n241  180320_D007T01_L12_D007T01V036L12          <NA> 491376.0625\n242  180320_D007T01_L12_D007T01V036L12          <NA> 173591.0924\n243  180320_D007T01_L12_D007T01V036L12          <NA> 333556.3054\n244  180320_D007T01_L12_D007T01V036L12          <NA> 500073.8819\n245  180320_D007T01_L12_D007T01V036L12          <NA> 329256.0025\n246  180320_D007T01_L12_D007T01V036L12          <NA> 289344.8477\n247  180320_D007T01_L12_D007T01V036L12          <NA> 268033.9206",
        "\n248  180320_D007T01_L12_D007T01V036L12          <NA> 451885.1594\n249  180320_D007T01_L12_D007T01V036L12          DMSO 470668.3970\n250  180320_D007T01_L12_D007T01V036L12          <NA> 478793.4660\n251  180320_D007T01_L12_D007T01V036L12          <NA> 293720.1992\n252  180320_D007T01_L12_D007T01V036L12          <NA> 512518.4295\n253  180320_D007T01_L12_D007T01V036L12          <NA> 414946.0927\n254  180320_D007T01_L12_D007T01V036L12          <NA> 298664.1336\n255  180320_D007T01_L12_D007T01V036L12          <NA> 159136.8990",
        "\n256  180320_D007T01_L12_D007T01V036L12          <NA> 151468.7356\n257  180320_D007T01_L12_D007T01V036L12          <NA> 308293.9900\n258  180320_D007T01_L12_D007T01V036L12          <NA> 278587.0088\n259  180320_D007T01_L12_D007T01V036L12          <NA> 466369.7088\n260  180320_D007T01_L12_D007T01V036L12          <NA> 487152.4172\n261  180320_D007T01_L12_D007T01V036L12          <NA> 503362.0971\n262  180320_D007T01_L12_D007T01V036L12          <NA> 349045.7112\n263  180320_D007T01_L12_D007T01V036L12 Staurosporine  13950.2225",
        "\n264  180320_D007T01_L12_D007T01V036L12          DMSO 514142.5938\n265  180320_D007T01_L12_D007T01V036L12          <NA> 433272.8805\n266  180320_D007T01_L12_D007T01V036L12          DMSO 482022.2757\n267  180320_D007T01_L12_D007T01V036L12          <NA> 436809.5787\n268  180320_D007T01_L12_D007T01V036L12          <NA> 449195.5202\n269  180320_D007T01_L12_D007T01V036L12          <NA> 417610.8310\n270  180320_D007T01_L12_D007T01V036L12          DMSO 490726.2416\n271  180320_D007T01_L12_D007T01V036L12          <NA> 315167.4314",
        "\n272  180320_D007T01_L12_D007T01V036L12          <NA> 463634.2210\n273  180320_D007T01_L12_D007T01V036L12          <NA> 343773.5536\n274  180320_D007T01_L12_D007T01V036L12          <NA> 175862.3725\n275  180320_D007T01_L12_D007T01V036L12          <NA> 294497.6208\n276  180320_D007T01_L12_D007T01V036L12          <NA> 489206.2417\n277  180320_D007T01_L12_D007T01V036L12          <NA> 259997.9594\n278  180320_D007T01_L12_D007T01V036L12          <NA> 304275.5722\n279  180320_D007T01_L12_D007T01V036L12          DMSO 499070.6352",
        "\n280  180320_D007T01_L12_D007T01V036L12          <NA> 344344.7030\n281  180320_D007T01_L12_D007T01V036L12          <NA> 483379.3304\n282  180320_D007T01_L12_D007T01V036L12          DMSO 505136.0724\n283  180320_D007T01_L12_D007T01V036L12          <NA> 177965.1264\n284  180320_D007T01_L12_D007T01V036L12          DMSO 465750.2954\n285  180320_D007T01_L12_D007T01V036L12          <NA> 342698.5426\n286  180320_D007T01_L12_D007T01V036L12          <NA> 202056.8310\n287  180320_D007T01_L12_D007T01V036L12          <NA> 341032.1239",
        "\n288  180320_D007T01_L12_D007T01V036L12          <NA> 541031.3843\n289  180320_D007T01_L12_D007T01V036L12          <NA> 122844.9236\n290  180320_D007T01_L12_D007T01V036L12          <NA> 469558.7128\n291  180320_D007T01_L12_D007T01V036L12          <NA> 250075.4041\n292  180320_D007T01_L12_D007T01V036L12          <NA> 191987.8965\n293  180320_D007T01_L12_D007T01V036L12          <NA> 140299.0890\n294  180320_D007T01_L12_D007T01V036L12          <NA> 387361.8805\n295  180320_D007T01_L12_D007T01V036L12          <NA> 472907.3919",
        "\n296  180320_D007T01_L12_D007T01V036L12          <NA> 439696.4226\n297  180320_D007T01_L12_D007T01V036L12          <NA> 462511.3901\n298  180320_D007T01_L12_D007T01V036L12          <NA> 451104.7118\n299  180320_D007T01_L12_D007T01V036L12          <NA> 170348.8049\n300  180320_D007T01_L12_D007T01V036L12          <NA> 261656.0869\n301  180320_D007T01_L12_D007T01V036L12          <NA> 446473.1835\n302  180320_D007T01_L12_D007T01V036L12          <NA> 303383.7422\n303  180320_D007T01_L12_D007T01V036L12          <NA> 516550.7130",
        "\n304  180320_D007T01_L12_D007T01V036L12          DMSO 495497.0459\n305  180320_D007T01_L12_D007T01V036L12          <NA> 331015.6907\n306  180320_D007T01_L12_D007T01V036L12 Staurosporine   4039.5975\n307  180320_D007T01_L12_D007T01V036L12          DMSO 548372.1344\n308  180320_D007T01_L12_D007T01V036L12          DMSO 522734.7313\n309  180320_D007T01_L12_D007T01V036L12 Staurosporine  17802.4305\n310  180320_D007T01_L12_D007T01V036L12          <NA> 543060.2745\n311  180320_D007T01_L12_D007T01V036L12          <NA> 499023.3057",
        "\n312  180320_D007T01_L12_D007T01V036L12          <NA> 248626.5665\n313  180320_D007T01_L12_D007T01V036L12          <NA> 465868.3613\n314  180320_D007T01_L12_D007T01V036L12          <NA> 129000.4382\n315  180320_D007T01_L12_D007T01V036L12          <NA> 461387.2556\n316  180320_D007T01_L12_D007T01V036L12          <NA> 429948.1717\n317  180320_D007T01_L12_D007T01V036L12          <NA> 273022.5451\n318  180320_D007T01_L12_D007T01V036L12          <NA> 253069.7344\n319  180320_D007T01_L12_D007T01V036L12          <NA> 482078.7906",
        "\n320  180320_D007T01_L12_D007T01V036L12          <NA> 337062.8774\n321  180320_D007T01_L12_D007T01V036L12          <NA> 481692.5221\n322  180320_D007T01_L12_D007T01V036L12 Staurosporine -21441.7482\n323  180320_D007T01_L12_D007T01V036L12          <NA> 153650.5939\n324  180320_D007T01_L12_D007T01V036L12          <NA> 369940.0755\n325  180320_D007T01_L12_D007T01V036L12          <NA> 153185.9058\n326  180320_D007T01_L12_D007T01V036L12          DMSO 471972.8537\n327  180320_D007T01_L12_D007T01V036L12          <NA> 507024.7858",
        "\n328  180320_D007T01_L12_D007T01V036L12          <NA> 487905.5689\n329  180320_D007T01_L12_D007T01V036L12          <NA> 179079.0696\n330  180320_D007T01_L12_D007T01V036L12          <NA> 250739.1546\n331  180320_D007T01_L12_D007T01V036L12          <NA> 303752.8778\n332  180320_D007T01_L12_D007T01V036L12          <NA> 231050.9939\n333  180320_D007T01_L12_D007T01V036L12          <NA> 409362.9206\n [ reached getOption(\"max.print\") -- omitted 1203 rows ]\n",
        "> ",
        "  filter(drug == \"DMSO\") %>% group_by(id) %>% ",
        "+ ",
        "  mutate(neg_control_median = median(pcount_norm, na.rm = TRUE))",
        "Error in filter(drug == \"DMSO\") : object 'drug' not found\n",
        "> ",
        "ctg_loess %>% ",
        "+ ",
        "  dplyr::select(id, drug, pcount_norm) %>%",
        "+ ",
        "  filter(drug == \"DMSO\") %>% group_by(id) %>% ",
        "+ ",
        "  mutate(neg_control_median = median(pcount_norm, na.rm = TRUE))",
        "[38;5;246m# A tibble: 160 x 4[39m\n[38;5;246m# Groups:   id [4][39m\n   id                                drug  pcount_norm neg_control_median\n   [3m[38;5;246m<chr>[39m[23m                             [3m[38;5;246m<chr>[39m[23m       [3m[38;5;246m<dbl>[39m[23m              [3m[38;5;246m<dbl>[39m[23m\n[38;5;250m 1[39m 180320_D007T01_L12_D007T01V036L12 DMSO      [4m5[24m[4m3[24m[4m1[24m814.            [4m4[24m[4m9[24m[4m7[24m284.\n[38;5;250m 2[39m 180320_D007T01_L12_D007T01V036L12 DMSO      [4m5[24m[4m3[24m[4m7[24m070.            [4m4[24m[4m9[24m[4m7[24m284.\n",
        "[38;5;250m 3[39m 180320_D007T01_L12_D007T01V036L12 DMSO      [4m5[24m[4m0[24m[4m0[24m681.            [4m4[24m[4m9[24m[4m7[24m284.\n[38;5;250m 4[39m 180320_D007T01_L12_D007T01V036L12 DMSO      [4m6[24m[4m0[24m[4m7[24m358.            [4m4[24m[4m9[24m[4m7[24m284.\n[38;5;250m 5[39m 180320_D007T01_L12_D007T01V036L12 DMSO      [4m5[24m[4m1[24m[4m8[24m595.            [4m4[24m[4m9[24m[4m7[24m284.\n[38;5;250m 6[39m 180320_D007T01_L12_D007T01V036L12 DMSO      [4m5[24m[4m0[24m[4m6[24m106.            [4m4[24m[4m9[24m[4m7[24m284.\n",
        "[38;5;250m 7[39m 180320_D007T01_L12_D007T01V036L12 DMSO      [4m4[24m[4m9[24m[4m0[24m845.            [4m4[24m[4m9[24m[4m7[24m284.\n[38;5;250m 8[39m 180320_D007T01_L12_D007T01V036L12 DMSO      [4m5[24m[4m3[24m[4m2[24m655.            [4m4[24m[4m9[24m[4m7[24m284.\n[38;5;250m 9[39m 180320_D007T01_L12_D007T01V036L12 DMSO      [4m4[24m[4m9[24m[4m5[24m086.            [4m4[24m[4m9[24m[4m7[24m284.\n[38;5;250m10[39m 180320_D007T01_L12_D007T01V036L12 DMSO      [4m4[24m[4m4[24m[4m1[24m512.            [4m4[24m[4m9[24m[4m7[24m284.\n",
        "[38;5;246m# ... with 150 more rows[39m\n",
        "> ",
        "ctg_ln <- left_join(ctg_loess, ctg_loess %>% ",
        "+ ",
        "  dplyr::select(id, drug, pcount_norm) %>%",
        "+ ",
        "  filter(drug == \"DMSO\") %>% group_by(id) %>% ",
        "+ ",
        "  mutate(neg_control_median = median(pcount_norm, na.rm = TRUE))) %>% ",
        "+ ",
        "  mutate(viability = pcount_norm/neg_control_median)",
        "Joining, by = c(\"id\", \"pcount_norm\", \"drug\")\n",
        "> ",
        "ctg_ln %>% ",
        "+ ",
        "    mutate(line_date_exp = paste0(line, \"_\", date)) %>%",
        "+ ",
        "    ggplot(aes(date, viability)) +",
        "+ ",
        "    geom_violin(aes(group = date,  color = date)) + ",
        "+ ",
        "    #geom_jitter(alpha = 0.7) +",
        "+ ",
        "    geom_boxplot(data = ctg_ln %>% filter(drug == \"DMSO\"), aes(group = date), width = 0.25) +",
        "+ ",
        "    facet_grid(line ~ Library) +",
        "+ ",
        "    theme_bw() + theme(axis.text.x = element_text(angle = 90, hjust = 1))",
        "Warning message:\n",
        "Removed 1376 rows containing non-finite values (stat_ydensity). \n",
        "> ",
        "ctg_ln %>% View",
        "> ",
        "ctg_loess %>% ",
        "+ ",
        "  dplyr::select(id, drug, pcount_norm) %>%",
        "+ ",
        "  filter(drug == \"DMSO\") %>% group_by(id) %>% ",
        "+ ",
        "  summarise(neg_control_median = median(pcount_norm, na.rm = TRUE))",
        "[38;5;246m# A tibble: 4 x 2[39m\n  id                                neg_control_median\n  [3m[38;5;246m<chr>[39m[23m                                          [3m[38;5;246m<dbl>[39m[23m\n[38;5;250m1[39m 180320_D007T01_L12_D007T01V036L12            [4m4[24m[4m9[24m[4m7[24m284.\n[38;5;250m2[39m 180320_D027T01_L12_D027T01V037L12            [4m4[24m[4m8[24m[4m9[24m541.\n[38;5;250m3[39m 180327_D007T01_L12_D007T01V051L12            [4m2[24m[4m6[24m[4m7[24m677.\n[38;5;250m4[39m 180327_D027T01_L12_D027T01V052L12            [4m3[24m[4m5[24m[4m5[24m894.\n",
        "> ",
        "ctg_ln <- left_join(ctg_loess, ctg_loess %>% ",
        "+ ",
        "  dplyr::select(id, drug, pcount_norm) %>%",
        "+ ",
        "  filter(drug == \"DMSO\") %>% group_by(id) %>% ",
        "+ ",
        "  summarise(neg_control_median = median(pcount_norm, na.rm = TRUE))) %>% ",
        "+ ",
        "  mutate(viability = pcount_norm/neg_control_median)",
        "Joining, by = \"id\"\n",
        "> ",
        "ctg_ln %>% ",
        "+ ",
        "    mutate(line_date_exp = paste0(line, \"_\", date)) %>%",
        "+ ",
        "    ggplot(aes(date, viability)) +",
        "+ ",
        "    geom_violin(aes(group = date,  color = date)) + ",
        "+ ",
        "    #geom_jitter(alpha = 0.7) +",
        "+ ",
        "    geom_boxplot(data = ctg_ln %>% filter(drug == \"DMSO\"), aes(group = date), width = 0.25) +",
        "+ ",
        "    facet_grid(line ~ Library) +",
        "+ ",
        "    theme_bw() + theme(axis.text.x = element_text(angle = 90, hjust = 1))",
        "> ",
        "r <- ctg_ln %>%",
        "+ ",
        "  mutate(ctrl = ifelse(drug == \"DMSO\", \"negative\", \"none\")) %>% ",
        "+ ",
        "  mutate(ctrl = ifelse(drug == \"Staurosporine\", \"positive\", ctrl)) %>% ",
        "+ ",
        "  #filter(drug %in% coi) %>%",
        "+ ",
        "  dplyr::select(line, Library, date, viability, well, ctrl) %>% ",
        "+ ",
        "  unite(id, c(\"line\", \"Library\", \"well\")) %>%",
        "+ ",
        "  spread(date, viability) %>% ",
        "+ ",
        "  rename(rep1 = `180320`) %>%",
        "+ ",
        "  rename(rep2 = `180327`) %>%",
        "+ ",
        "  dplyr::select(rep1, rep2) %>% ",
        "+ ",
        "  as.matrix() %>%",
        "+ ",
        "  cor() %>%",
        "+ ",
        "  .[\"rep1\", \"rep2\"]",
        "> ",
        "",
        "> ",
        "ctg_ln %>%",
        "+ ",
        "  #filter(col_num != 13) %>% ",
        "+ ",
        "  mutate(ctrl = ifelse(drug == \"DMSO\", \"negative\", \"none\")) %>% ",
        "+ ",
        "  mutate(ctrl = ifelse(drug == \"Staurosporine\", \"positive\", ctrl)) %>% ",
        "+ ",
        "  #filter(drug %in% coi) %>%",
        "+ ",
        "  dplyr::select(line, Library, date, viability, well, ctrl) %>% ",
        "+ ",
        "  unite(id, c(\"line\", \"Library\", \"well\")) %>%",
        "+ ",
        "  spread(date, viability) %>% ",
        "+ ",
        "  rename(rep1 = `180320`) %>%",
        "+ ",
        "  rename(rep2 = `180327`) %>%",
        "+ ",
        "  ggplot(aes(rep1, rep2)) + ",
        "+ ",
        "  geom_point(alpha = 0.2) +",
        "+ ",
        "  #geom_point(alpha = 0.2, aes(color = ctrl)) + ",
        "+ ",
        "  #scale_color_manual(values=c(\"#E69F00\", \"#999999\", \"#56B4E9\")) +",
        "+ ",
        "  geom_abline(intercept = 0, slope = 1) +",
        "+ ",
        "  theme_classic() + ",
        "+ ",
        "  ggtitle(paste0(\"r (pearson) = \", r %>% round(2))) + ",
        "+ ",
        "  xlab(\"replicate 1\") + ",
        "+ ",
        "  ylab(\"replicate 2\") + ",
        "+ ",
        "  scale_y_continuous(breaks = c(0, 0.5, 1, 1.5)) + ",
        "+ ",
        "  geom_hline(yintercept = 1) + ",
        "+ ",
        "  geom_vline(xintercept = 1) +",
        "+ ",
        "  coord_fixed() + ",
        "+ ",
        "  ggsave(\"collab_pearson_norm.pdf\", width = 4, height = 4)",
        "> ",
        "coi <- c(\"DMSO\", \"Staurosporine\")",
        "> ",
        "",
        "> ",
        "ctg_ln %>%",
        "+ ",
        "  filter(drug %in% coi & combination == FALSE) %>%",
        "+ ",
        "  ggplot(aes(id, viability)) +",
        "+ ",
        "  geom_boxplot(aes(colour = drug), width =1, position = \"identity\") + ",
        "+ ",
        "  theme_classic() + ",
        "+ ",
        "  #facet_grid(line~date) +",
        "+ ",
        "  #scale_y_continuous(limits = c(-1,250000)) +",
        "+ ",
        "  #ggtitle(\"Before DMSO normalization\") + ",
        "+ ",
        "  theme(axis.title.x=element_blank(),",
        "+ ",
        "        axis.text.x=element_blank()) +",
        "+ ",
        "  scale_color_manual(values=rev(c(\"#999999\", \"#000000\"))) +",
        "+ ",
        "  ylab(\"Photon count\")",
        "> ",
        "coi <- c(\"DMSO\", \"Staurosporine\")",
        "> ",
        "",
        "> ",
        "ctg_ln %>%",
        "+ ",
        "  filter(drug %in% coi & combination == FALSE) %>%",
        "+ ",
        "  ggplot(aes(id, viability)) +",
        "+ ",
        "  geom_boxplot(aes(colour = drug), width = 0.5, position = \"identity\") + ",
        "+ ",
        "  theme_classic() + ",
        "+ ",
        "  #facet_grid(line~date) +",
        "+ ",
        "  #scale_y_continuous(limits = c(-1,250000)) +",
        "+ ",
        "  #ggtitle(\"Before DMSO normalization\") + ",
        "+ ",
        "  theme(axis.title.x=element_blank(),",
        "+ ",
        "        axis.text.x=element_blank()) +",
        "+ ",
        "  scale_color_manual(values=rev(c(\"#999999\", \"#000000\"))) +",
        "+ ",
        "  ylab(\"Photon count\") +",
        "+ ",
        "  ggsave(\"collab_ctrls_norm_byplate_uncombined.pdf\", width = 6, height = 4)",
        "> ",
        "ctg_loess %>%",
        "+ ",
        "  filter(drug %in% coi & combination == FALSE) %>%",
        "+ ",
        "  ggplot(aes(id, pcount_norm)) +",
        "+ ",
        "  geom_boxplot(aes(colour = drug), width =.2, position = \"identity\") + ",
        "+ ",
        "  theme_classic() + ",
        "+ ",
        "  #facet_grid(line~date) +",
        "+ ",
        "  #scale_y_continuous(limits = c(-1,250000)) +",
        "+ ",
        "  #ggtitle(\"Before DMSO normalization\") + ",
        "+ ",
        "  theme(axis.title.y=element_blank()) +",
        "+ ",
        "  scale_color_manual(values=rev(c(\"#999999\", \"#000000\"))) +",
        "+ ",
        "  ylab(\"Photon count\") +",
        "+ ",
        "  #theme(axis.text.x = element_text(angle = 90, hjust = 1)) +",
        "+ ",
        "  coord_flip() +",
        "+ ",
        "  ggsave(\"collab_ctrls_raw_byplate_uncombined.pdf\", width = 6, height = 4)",
        "> ",
        "ctg_ln %>%",
        "+ ",
        "  filter(drug %in% coi & combination == FALSE) %>%",
        "+ ",
        "  ggplot(aes(id, pcount_norm)) +",
        "+ ",
        "  geom_boxplot(aes(colour = drug), width =.2, position = \"identity\") + ",
        "+ ",
        "  theme_classic() + ",
        "+ ",
        "  #facet_grid(line~date) +",
        "+ ",
        "  #scale_y_continuous(limits = c(-1,250000)) +",
        "+ ",
        "  #ggtitle(\"Before DMSO normalization\") + ",
        "+ ",
        "  theme(axis.title.y=element_blank()) +",
        "+ ",
        "  scale_color_manual(values=rev(c(\"#999999\", \"#000000\"))) +",
        "+ ",
        "  ylab(\"Photon count\") +",
        "+ ",
        "  #theme(axis.text.x = element_text(angle = 90, hjust = 1)) +",
        "+ ",
        "  coord_flip() +",
        "+ ",
        "  ggsave(\"collab_ctrls_norm_byplate_uncombined.pdf\", width = 6, height = 4)",
        "> ",
        "ctg_ln %>%",
        "+ ",
        "  filter(drug %in% coi & combination == FALSE) %>%",
        "+ ",
        "  ggplot(aes(id, viability)) +",
        "+ ",
        "  geom_boxplot(aes(colour = drug), width =.2, position = \"identity\") + ",
        "+ ",
        "  theme_classic() + ",
        "+ ",
        "  #facet_grid(line~date) +",
        "+ ",
        "  #scale_y_continuous(limits = c(-1,250000)) +",
        "+ ",
        "  #ggtitle(\"Before DMSO normalization\") + ",
        "+ ",
        "  theme(axis.title.y=element_blank()) +",
        "+ ",
        "  scale_color_manual(values=rev(c(\"#999999\", \"#000000\"))) +",
        "+ ",
        "  ylab(\"Photon count\") +",
        "+ ",
        "  #theme(axis.text.x = element_text(angle = 90, hjust = 1)) +",
        "+ ",
        "  coord_flip() +",
        "+ ",
        "  ggsave(\"collab_ctrls_norm_byplate_uncombined.pdf\", width = 6, height = 4)",
        "> ",
        "coi <- c(\"DMSO\", \"Staurosporine\")",
        "> ",
        "ctg_ln %>%",
        "+ ",
        "    filter(!drug %in% coi)",
        "     row_num col_num pcount                                id norm_fac pcount_norm                            name well                          screen\n1          1       1 321310 180320_D007T01_L12_D007T01V036L12 365377.2   321318.96 180320_JB_M3_HCO-D007T01V036L11  A01 180320_JB_M3_HCO-D007T01V036L12\n2          1       2 330060 180320_D007T01_L12_D007T01V036L12 358499.1   336947.05 180320_JB_M3_HCO-D007T01V036L11  A02 180320_JB_M3_HCO-D007T01V036L12\n3          1       3 486290 180320_D007T01_L12_D007T01V036L12",
        " 353141.8   498534.41 180320_JB_M3_HCO-D007T01V036L11  A03 180320_JB_M3_HCO-D007T01V036L12\n4          1       4 474070 180320_D007T01_L12_D007T01V036L12 348877.9   490578.26 180320_JB_M3_HCO-D007T01V036L11  A04 180320_JB_M3_HCO-D007T01V036L12\n5          1       5 432990 180320_D007T01_L12_D007T01V036L12 345280.4   453095.82 180320_JB_M3_HCO-D007T01V036L11  A05 180320_JB_M3_HCO-D007T01V036L12\n6          1       6 164310 180320_D007T01_L12_D007T01V036L12 341921.9   187774.30 180320_JB_M3_HCO-D007T01V036L11  A06",
        " 180320_JB_M3_HCO-D007T01V036L12\n7          1       7 527080 180320_D007T01_L12_D007T01V036L12 339279.2   553186.99 180320_JB_M3_HCO-D007T01V036L11  A07 180320_JB_M3_HCO-D007T01V036L12\n8          1       8 211670 180320_D007T01_L12_D007T01V036L12 337883.6   239172.56 180320_JB_M3_HCO-D007T01V036L11  A08 180320_JB_M3_HCO-D007T01V036L12\n9          1      12 499620 180320_D007T01_L12_D007T01V036L12 337866.5   527139.72 180320_JB_M3_HCO-D007T01V036L11  A12 180320_JB_M3_HCO-D007T01V036L12\n10         1      14 183430",
        " 180320_D007T01_L12_D007T01V036L12 339244.1   209572.07 180320_JB_M3_HCO-D007T01V036L11  A14 180320_JB_M3_HCO-D007T01V036L12\n11         1      15 202870 180320_D007T01_L12_D007T01V036L12 340802.2   227454.02 180320_JB_M3_HCO-D007T01V036L11  A15 180320_JB_M3_HCO-D007T01V036L12\n12         1      16 345600 180320_D007T01_L12_D007T01V036L12 342737.5   368248.65 180320_JB_M3_HCO-D007T01V036L11  A16 180320_JB_M3_HCO-D007T01V036L12\n13         1      18 289360 180320_D007T01_L12_D007T01V036L12 347133.7   307612.47 180320_JB_M3_HCO-D007T01V036L11",
        "  A18 180320_JB_M3_HCO-D007T01V036L12\n14         1      19 464810 180320_D007T01_L12_D007T01V036L12 349179.9   481016.31 180320_JB_M3_HCO-D007T01V036L11  A19 180320_JB_M3_HCO-D007T01V036L12\n15         1      20 435770 180320_D007T01_L12_D007T01V036L12 350946.8   450209.39 180320_JB_M3_HCO-D007T01V036L11  A20 180320_JB_M3_HCO-D007T01V036L12\n16         1      21 170970 180320_D007T01_L12_D007T01V036L12 352542.0   183814.23 180320_JB_M3_HCO-D007T01V036L11  A21 180320_JB_M3_HCO-D007T01V036L12\n17         1      22",
        " 357620 180320_D007T01_L12_D007T01V036L12 354072.8   368933.35 180320_JB_M3_HCO-D007T01V036L11  A22 180320_JB_M3_HCO-D007T01V036L12\n18         1      23 519720 180320_D007T01_L12_D007T01V036L12 355646.9   529459.24 180320_JB_M3_HCO-D007T01V036L11  A23 180320_JB_M3_HCO-D007T01V036L12\n19         1      24 477500 180320_D007T01_L12_D007T01V036L12 357371.8   485514.44 180320_JB_M3_HCO-D007T01V036L11  A24 180320_JB_M3_HCO-D007T01V036L12\n20         2       1 451770 180320_D007T01_L12_D007T01V036L12 363108.5   454047.68",
        " 180320_JB_M3_HCO-D007T01V036L11  B01 180320_JB_M3_HCO-D007T01V036L12\n21         2       2 238890 180320_D007T01_L12_D007T01V036L12 355777.6   248498.61 180320_JB_M3_HCO-D007T01V036L11  B02 180320_JB_M3_HCO-D007T01V036L12\n22         2       4 254600 180320_D007T01_L12_D007T01V036L12 344548.4   275437.75 180320_JB_M3_HCO-D007T01V036L11  B04 180320_JB_M3_HCO-D007T01V036L12\n23         2       5 511530 180320_D007T01_L12_D007T01V036L12 340228.7   536687.52 180320_JB_M3_HCO-D007T01V036L11  B05 180320_JB_M3_HCO-D007T01V036L12",
        "\n24         2       7 295800 180320_D007T01_L12_D007T01V036L12 333737.3   327448.85 180320_JB_M3_HCO-D007T01V036L11  B07 180320_JB_M3_HCO-D007T01V036L12\n25         2       9 167040 180320_D007T01_L12_D007T01V036L12 331768.9   200657.28 180320_JB_M3_HCO-D007T01V036L11  B09 180320_JB_M3_HCO-D007T01V036L12\n26         2      10 357640 180320_D007T01_L12_D007T01V036L12 331861.0   391165.24 180320_JB_M3_HCO-D007T01V036L11  B10 180320_JB_M3_HCO-D007T01V036L12\n27         2      11 164290 180320_D007T01_L12_D007T01V036L12",
        " 332208.3   197467.87 180320_JB_M3_HCO-D007T01V036L11  B11 180320_JB_M3_HCO-D007T01V036L12\n28         2      12 293950 180320_D007T01_L12_D007T01V036L12 332464.4   326871.76 180320_JB_M3_HCO-D007T01V036L11  B12 180320_JB_M3_HCO-D007T01V036L12\n29         2      13 177130 180320_D007T01_L12_D007T01V036L12 333224.8   209291.44 180320_JB_M3_HCO-D007T01V036L11  B13 180320_JB_M3_HCO-D007T01V036L12\n       date operator mithras organism     experiment Numbering Donor Tumor Plate Library planned_date Replicate assay",
        " Row Col BlockID DrugRow DrugCol row\n1    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   4   2      EF       E       F   A\n2    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   1   1      CD       C       D   A\n3    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   2   6      CD       C       D   A\n4    180320       JB",
        "      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   3   2      CD       C       D   A\n5    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   2   3      CD       C       D   A\n6    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   2   2      AB       A       B   A\n7    180320       JB      M3      HCO D007T01V036L12        51  D007   T01",
        "  V036     L12   2018-03-13         1   CTG   6   6      EF       E       F   A\n8    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   3   2      AB       A       B   A\n9    180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   4   4      CD       C       D   A\n10   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   3   6",
        "      AB       A       B   A\n11   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   4   4      AB       A       B   A\n12   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   1   6      EF       E       F   A\n13   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   5   3      AB       A       B   A\n14   180320       JB      M3",
        "      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   3   3      CD       C       D   A\n15   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   6   4      CD       C       D   A\n16   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   2   4      AB       A       B   A\n17   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036",
        "     L12   2018-03-13         1   CTG   5   6      AB       A       B   A\n18   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   4   5      CD       C       D   A\n19   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   5   6      EF       E       F   A\n20   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   3   1      CD",
        "       C       D   B\n21   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   5   5      AB       A       B   B\n22   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   4   2      AB       A       B   B\n23   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   6   4      EF       E       F   B\n24   180320       JB      M3      HCO",
        " D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   1   4      CD       C       D   B\n25   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   3   2      AB       A       B   B\n26   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   4   2      EF       E       F   B\n27   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12",
        "   2018-03-13         1   CTG   1   5      AB       A       B   B\n28   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   1   5      EF       E       F   B\n29   180320       JB      M3      HCO D007T01V036L12        51  D007   T01  V036     L12   2018-03-13         1   CTG   2   5      AB       A       B   B\n     col drug combination    line neg_control_median viability\n1     01 <NA>        TRUE D007T01           497283.8 0.6461480\n2     02 <NA>",
        "        TRUE D007T01           497283.8 0.6775749\n3     03 <NA>        TRUE D007T01           497283.8 1.0025148\n4     04 <NA>        TRUE D007T01           497283.8 0.9865156\n5     05 <NA>        TRUE D007T01           497283.8 0.9111413\n6     06 <NA>        TRUE D007T01           497283.8 0.3775998\n7     07 <NA>        TRUE D007T01           497283.8 1.1124170\n8     08 <NA>        TRUE D007T01           497283.8 0.4809578\n9     12 <NA>        TRUE D007T01           497283.8 1.0600379\n10    14 <NA>        TRUE",
        " D007T01           497283.8 0.4214335\n11    15 <NA>        TRUE D007T01           497283.8 0.4573927\n12    16 <NA>        TRUE D007T01           497283.8 0.7405200\n13    18 <NA>        TRUE D007T01           497283.8 0.6185853\n14    19 <NA>        TRUE D007T01           497283.8 0.9672872\n15    20 <NA>        TRUE D007T01           497283.8 0.9053369\n16    21 <NA>        TRUE D007T01           497283.8 0.3696365\n17    22 <NA>        TRUE D007T01           497283.8 0.7418969\n18    23 <NA>        TRUE D007T01",
        "           497283.8 1.0647023\n19    24 <NA>        TRUE D007T01           497283.8 0.9763326\n20    01 <NA>        TRUE D007T01           497283.8 0.9130554\n21    02 <NA>        TRUE D007T01           497283.8 0.4997118\n22    04 <NA>        TRUE D007T01           497283.8 0.5538844\n23    05 <NA>        TRUE D007T01           497283.8 1.0792378\n24    07 <NA>        TRUE D007T01           497283.8 0.6584747\n25    09 <NA>        TRUE D007T01           497283.8 0.4035065\n26    10 <NA>        TRUE D007T01           497283.8",
        " 0.7866036\n27    11 <NA>        TRUE D007T01           497283.8 0.3970929\n28    12 <NA>        TRUE D007T01           497283.8 0.6573143\n29    13 <NA>        TRUE D007T01           497283.8 0.4208692\n [ reached getOption(\"max.print\") -- omitted 1267 rows ]\n",
        "> ",
        "ctg_ln %>%",
        "+ ",
        "    filter(!drug %in% coi) %>% colnames()",
        " [1] \"row_num\"            \"col_num\"            \"pcount\"             \"id\"                 \"norm_fac\"           \"pcount_norm\"        \"name\"              \n [8] \"well\"               \"screen\"             \"date\"               \"operator\"           \"mithras\"            \"organism\"           \"experiment\"        \n[15] \"Numbering\"          \"Donor\"              \"Tumor\"              \"Plate\"              \"Library\"            \"planned_date\"       \"Replicate\"         \n[22] \"assay\"              \"Row\"                \"Col\"               ",
        " \"BlockID\"            \"DrugRow\"            \"DrugCol\"            \"row\"               \n[29] \"col\"                \"drug\"               \"combination\"        \"line\"               \"neg_control_median\" \"viability\"         \n",
        "> ",
        "25/(5^(as.numeric(3)-1))",
        "[1] 1\n",
        "> ",
        "25/(5^(as.numeric(4)-1))",
        "[1] 0.2\n",
        "> ",
        "25/(5^(as.numeric(1)-1))",
        "[1] 25\n",
        "> ",
        "25/(5^(as.numeric(2)-1))",
        "[1] 5\n",
        "> ",
        "25/(5^(as.numeric(5)-1))",
        "[1] 0.04\n",
        "> ",
        "syn_drug <- ctg_ln %>%",
        "+ ",
        "    filter(!drug %in% coi) %>%",
        "+ ",
        "    #filter(query != \"L11DM\") %>%",
        "+ ",
        "    #filter(combination == TRUE) %>%",
        "+ ",
        "    rename(rv = viability) %>%",
        "+ ",
        "    #setup the easy stuff",
        "+ ",
        "    dplyr::transmute(",
        "+ ",
        "      #BlockID = paste(query, drug, sep = \"_\"),",
        "+ ",
        "           Response = rv*100,",
        "+ ",
        "           Replicate = ifelse(date == \"180320\", 1, 2),",
        "+ ",
        "           DrugRow = DrugRow,",
        "+ ",
        "           DrugCol = DrugCol,",
        "+ ",
        "           #build matrix",
        "+ ",
        "           Col = Col,",
        "+ ",
        "           Row = Row,",
        "+ ",
        "           #define concentrations",
        "+ ",
        "           ConcRow = ifelse(Row == 6, 0, 25/(5^(as.numeric(Row)-1))), #assuming the initila concentration is 50",
        "+ ",
        "           ConcCol = ifelse(Col == 6, 0, 25/(5^(as.numeric(Col)-1))),",
        "+ ",
        "           ConcUnit = \"uM\",",
        "+ ",
        "      line = line, ",
        "+ ",
        "      BlockID = BlockID",
        "+ ",
        "      ",
        "+ ",
        "           ) #%>% mutate(BlockID = paste(query, drug, sep = \"_\"))",
        "> ",
        "syn_drug",
        "      Response Replicate DrugRow DrugCol Col Row ConcRow ConcCol ConcUnit    line BlockID\n1     64.61480         1       E       F   2   4    0.20    5.00       uM D007T01      EF\n2     67.75749         1       C       D   1   1   25.00   25.00       uM D007T01      CD\n3    100.25148         1       C       D   6   2    5.00    0.00       uM D007T01      CD\n4     98.65156         1       C       D   2   3    1.00    5.00       uM D007T01      CD\n5     91.11413         1       C       D   3   2    5.00    1.00",
        "       uM D007T01      CD\n6     37.75998         1       A       B   2   2    5.00    5.00       uM D007T01      AB\n7    111.24170         1       E       F   6   6    0.00    0.00       uM D007T01      EF\n8     48.09578         1       A       B   2   3    1.00    5.00       uM D007T01      AB\n9    106.00379         1       C       D   4   4    0.20    0.20       uM D007T01      CD\n10    42.14335         1       A       B   6   3    1.00    0.00       uM D007T01      AB\n11    45.73927         1       A       B",
        "   4   4    0.20    0.20       uM D007T01      AB\n12    74.05200         1       E       F   6   1   25.00    0.00       uM D007T01      EF\n13    61.85853         1       A       B   3   5    0.04    1.00       uM D007T01      AB\n14    96.72872         1       C       D   3   3    1.00    1.00       uM D007T01      CD\n15    90.53369         1       C       D   4   6    0.00    0.20       uM D007T01      CD\n16    36.96365         1       A       B   4   2    5.00    0.20       uM D007T01      AB\n17    74.18969",
        "         1       A       B   6   5    0.04    0.00       uM D007T01      AB\n18   106.47023         1       C       D   5   4    0.20    0.04       uM D007T01      CD\n19    97.63326         1       E       F   6   5    0.04    0.00       uM D007T01      EF\n20    91.30554         1       C       D   1   3    1.00   25.00       uM D007T01      CD\n21    49.97118         1       A       B   5   5    0.04    0.04       uM D007T01      AB\n22    55.38844         1       A       B   2   4    0.20    5.00       uM D007T01",
        "      AB\n23   107.92378         1       E       F   4   6    0.00    0.20       uM D007T01      EF\n24    65.84747         1       C       D   4   1   25.00    0.20       uM D007T01      CD\n25    40.35065         1       A       B   2   3    1.00    5.00       uM D007T01      AB\n26    78.66036         1       E       F   2   4    0.20    5.00       uM D007T01      EF\n27    39.70929         1       A       B   5   1   25.00    0.04       uM D007T01      AB\n28    65.73143         1       E       F   5   1   25.00",
        "    0.04       uM D007T01      EF\n29    42.08692         1       A       B   5   2    5.00    0.04       uM D007T01      AB\n30    66.31096         1       E       F   2   3    1.00    5.00       uM D007T01      EF\n31    44.00776         1       A       B   2   2    5.00    5.00       uM D007T01      AB\n32    64.40104         1       E       F   4   1   25.00    0.20       uM D007T01      EF\n33    63.89890         1       C       D   5   1   25.00    0.04       uM D007T01      CD\n34    71.70414         1       A",
        "       B   1   5    0.04   25.00       uM D007T01      AB\n35    56.36729         1       A       B   4   5    0.04    0.20       uM D007T01      AB\n36    72.11431         1       E       F   1   4    0.20   25.00       uM D007T01      EF\n37    58.22475         1       E       F   2   3    1.00    5.00       uM D007T01      EF\n38    83.48971         1       C       D   1   2    5.00   25.00       uM D007T01      CD\n39    66.70547         1       E       F   3   1   25.00    1.00       uM D007T01      EF\n40  ",
        "  55.63180         1       A       B   2   4    0.20    5.00       uM D007T01      AB\n41    46.18092         1       A       B   4   4    0.20    0.20       uM D007T01      AB\n42    93.05845         1       C       D   1   3    1.00   25.00       uM D007T01      CD\n43    71.18620         1       E       F   6   2    5.00    0.00       uM D007T01      EF\n44    64.18771         1       E       F   6   2    5.00    0.00       uM D007T01      EF\n45   102.47346         1       C       D   5   3    1.00    0.04       uM",
        " D007T01      CD\n46    63.57479         1       E       F   3   3    1.00    1.00       uM D007T01      EF\n47    90.64253         1       E       F   2   5    0.04    5.00       uM D007T01      EF\n48    90.37909         1       E       F   2   5    0.04    5.00       uM D007T01      EF\n49    62.78067         1       E       F   5   3    1.00    0.04       uM D007T01      EF\n50    92.79771         1       C       D   2   5    0.04    5.00       uM D007T01      CD\n51    91.58645         1       E       F   3   5",
        "    0.04    1.00       uM D007T01      EF\n52    94.52832         1       C       D   1   6    0.00   25.00       uM D007T01      CD\n53   100.13388         1       E       F   5   6    0.00    0.04       uM D007T01      EF\n54    74.69627         1       E       F   1   4    0.20   25.00       uM D007T01      EF\n55    62.22127         1       E       F   1   1   25.00   25.00       uM D007T01      EF\n56    65.93449         1       E       F   5   1   25.00    0.04       uM D007T01      EF\n57    62.49429         1",
        "       E       F   5   2    5.00    0.04       uM D007T01      EF\n58    95.34648         1       E       F   6   5    0.04    0.00       uM D007T01      EF\n59    37.66392         1       A       B   5   1   25.00    0.04       uM D007T01      AB\n60    83.84042         1       E       F   1   5    0.04   25.00       uM D007T01      EF\n61    62.86242         1       E       F   2   1   25.00    5.00       uM D007T01      EF\n62    97.69894         1       A       B   4   6    0.00    0.20       uM D007T01      AB",
        "\n63    42.05164         1       A       B   5   4    0.20    0.04       uM D007T01      AB\n64    44.02545         1       A       B   3   4    0.20    1.00       uM D007T01      AB\n65    60.32154         1       E       F   3   1   25.00    1.00       uM D007T01      EF\n66    65.55839         1       E       F   2   3    1.00    5.00       uM D007T01      EF\n67   109.94637         1       C       D   2   6    0.00    5.00       uM D007T01      CD\n68    87.98882         1       C       D   4   2    5.00    0.20",
        "       uM D007T01      CD\n69    96.25606         1       C       D   5   4    0.20    0.04       uM D007T01      CD\n70    64.35991         1       C       D   5   1   25.00    0.04       uM D007T01      CD\n71    68.28155         1       E       F   4   2    5.00    0.20       uM D007T01      EF\n72    45.88907         1       A       B   3   4    0.20    1.00       uM D007T01      AB\n73    95.10522         1       A       B   1   6    0.00   25.00       uM D007T01      AB\n74    71.55855         1       A       B",
        "   1   5    0.04   25.00       uM D007T01      AB\n75    54.04793         1       E       F   3   4    0.20    1.00       uM D007T01      EF\n76    64.74060         1       E       F   6   2    5.00    0.00       uM D007T01      EF\n77   101.93161         1       C       D   2   4    0.20    5.00       uM D007T01      CD\n78    38.64702         1       A       B   5   3    1.00    0.04       uM D007T01      AB\n79    36.27154         1       A       B   2   3    1.00    5.00       uM D007T01      AB\n80    41.04513",
        "         1       A       B   6   4    0.20    0.00       uM D007T01      AB\n81    92.09437         1       C       D   5   2    5.00    0.04       uM D007T01      CD\n82    62.64257         1       E       F   6   3    1.00    0.00       uM D007T01      EF\n83    58.89249         1       A       B   5   5    0.04    0.04       uM D007T01      AB\n84    82.21465         1       C       D   3   2    5.00    1.00       uM D007T01      CD\n85    87.68309         1       C       D   6   2    5.00    0.00       uM D007T01",
        "      CD\n86    63.85500         1       E       F   2   2    5.00    5.00       uM D007T01      EF\n87    43.27260         1       A       B   2   4    0.20    5.00       uM D007T01      AB\n88    91.40408         1       C       D   3   6    0.00    1.00       uM D007T01      CD\n89    89.29101         1       C       D   6   6    0.00    0.00       uM D007T01      CD\n90    99.58607         1       C       D   5   6    0.00    0.04       uM D007T01      CD\n [ reached getOption(\"max.print\") -- omitted 1206 rows ]\n",
        "> ",
        "syn_drug %>% View",
        "> ",
        "syn_drug %>% distinct() %>% View",
        "> ",
        "syn_drug %>% filter(BlockID == \"CD\")",
        "     Response Replicate DrugRow DrugCol Col Row ConcRow ConcCol ConcUnit    line BlockID\n1    67.75749         1       C       D   1   1   25.00   25.00       uM D007T01      CD\n2   100.25148         1       C       D   6   2    5.00    0.00       uM D007T01      CD\n3    98.65156         1       C       D   2   3    1.00    5.00       uM D007T01      CD\n4    91.11413         1       C       D   3   2    5.00    1.00       uM D007T01      CD\n5   106.00379         1       C       D   4   4    0.20    0.20       uM",
        " D007T01      CD\n6    96.72872         1       C       D   3   3    1.00    1.00       uM D007T01      CD\n7    90.53369         1       C       D   4   6    0.00    0.20       uM D007T01      CD\n8   106.47023         1       C       D   5   4    0.20    0.04       uM D007T01      CD\n9    91.30554         1       C       D   1   3    1.00   25.00       uM D007T01      CD\n10   65.84747         1       C       D   4   1   25.00    0.20       uM D007T01      CD\n11   63.89890         1       C       D   5   1   25.00",
        "    0.04       uM D007T01      CD\n12   83.48971         1       C       D   1   2    5.00   25.00       uM D007T01      CD\n13   93.05845         1       C       D   1   3    1.00   25.00       uM D007T01      CD\n14  102.47346         1       C       D   5   3    1.00    0.04       uM D007T01      CD\n15   92.79771         1       C       D   2   5    0.04    5.00       uM D007T01      CD\n16   94.52832         1       C       D   1   6    0.00   25.00       uM D007T01      CD\n17  109.94637         1       C       D",
        "   2   6    0.00    5.00       uM D007T01      CD\n18   87.98882         1       C       D   4   2    5.00    0.20       uM D007T01      CD\n19   96.25606         1       C       D   5   4    0.20    0.04       uM D007T01      CD\n20   64.35991         1       C       D   5   1   25.00    0.04       uM D007T01      CD\n21  101.93161         1       C       D   2   4    0.20    5.00       uM D007T01      CD\n22   92.09437         1       C       D   5   2    5.00    0.04       uM D007T01      CD\n23   82.21465         1",
        "       C       D   3   2    5.00    1.00       uM D007T01      CD\n24   87.68309         1       C       D   6   2    5.00    0.00       uM D007T01      CD\n25   91.40408         1       C       D   3   6    0.00    1.00       uM D007T01      CD\n26   89.29101         1       C       D   6   6    0.00    0.00       uM D007T01      CD\n27   99.58607         1       C       D   5   6    0.00    0.04       uM D007T01      CD\n28  102.81332         1       C       D   5   2    5.00    0.04       uM D007T01      CD\n29 ",
        "  71.43689         1       C       D   5   1   25.00    0.04       uM D007T01      CD\n30   99.50388         1       C       D   2   6    0.00    5.00       uM D007T01      CD\n31   96.78148         1       C       D   3   5    0.04    1.00       uM D007T01      CD\n32   70.52653         1       C       D   4   1   25.00    0.20       uM D007T01      CD\n33   92.94989         1       C       D   4   5    0.04    0.20       uM D007T01      CD\n34   93.14358         1       C       D   3   3    1.00    1.00       uM",
        " D007T01      CD\n35   62.12688         1       C       D   3   1   25.00    1.00       uM D007T01      CD\n36   92.64060         1       C       D   3   4    0.20    1.00       uM D007T01      CD\n37   93.02580         1       C       D   2   3    1.00    5.00       uM D007T01      CD\n38   95.53093         1       C       D   3   6    0.00    1.00       uM D007T01      CD\n39   79.18813         1       C       D   1   3    1.00   25.00       uM D007T01      CD\n40   96.96674         1       C       D   5   3    1.00",
        "    0.04       uM D007T01      CD\n41   69.94342         1       C       D   4   1   25.00    0.20       uM D007T01      CD\n42   68.23049         1       C       D   3   5    0.04    1.00       uM D007T01      CD\n43   97.58110         1       C       D   6   5    0.04    0.00       uM D007T01      CD\n44   87.44451         1       C       D   4   5    0.04    0.20       uM D007T01      CD\n45   87.55498         1       C       D   5   6    0.00    0.04       uM D007T01      CD\n46   87.43438         1       C       D",
        "   1   4    0.20   25.00       uM D007T01      CD\n47   86.50235         1       C       D   4   2    5.00    0.20       uM D007T01      CD\n48   99.39214         1       C       D   2   5    0.04    5.00       uM D007T01      CD\n49   87.88222         1       C       D   1   5    0.04   25.00       uM D007T01      CD\n50   84.43499         1       C       D   1   6    0.00   25.00       uM D007T01      CD\n51   90.91296         1       C       D   1   4    0.20   25.00       uM D007T01      CD\n52   95.61256         1",
        "       C       D   5   5    0.04    0.04       uM D007T01      CD\n53   72.37890         1       C       D   6   1   25.00    0.00       uM D007T01      CD\n54   87.37737         1       C       D   4   3    1.00    0.20       uM D007T01      CD\n55   92.56877         1       C       D   2   4    0.20    5.00       uM D007T01      CD\n56   62.15893         1       C       D   2   1   25.00    5.00       uM D007T01      CD\n57   60.37068         1       C       D   6   1   25.00    0.00       uM D007T01      CD\n58 ",
        "  94.43397         1       C       D   6   5    0.04    0.00       uM D007T01      CD\n59   94.88702         1       C       D   5   3    1.00    0.04       uM D007T01      CD\n60   89.66758         1       C       D   6   3    1.00    0.00       uM D007T01      CD\n61   99.37302         1       C       D   4   2    5.00    0.20       uM D007T01      CD\n62   97.09662         1       C       D   4   6    0.00    0.20       uM D007T01      CD\n63   89.09475         1       C       D   2   2    5.00    5.00       uM",
        " D007T01      CD\n64   91.63767         1       C       D   6   3    1.00    0.00       uM D007T01      CD\n65   92.29957         1       C       D   2   5    0.04    5.00       uM D007T01      CD\n66   96.80841         1       C       D   6   5    0.04    0.00       uM D007T01      CD\n67   98.81199         1       C       D   3   3    1.00    1.00       uM D007T01      CD\n68  100.56106         1       C       D   6   4    0.20    0.00       uM D007T01      CD\n69   90.87067         1       C       D   4   6    0.00",
        "    0.20       uM D007T01      CD\n70   96.28173         1       C       D   3   4    0.20    1.00       uM D007T01      CD\n71   59.06490         1       C       D   1   1   25.00   25.00       uM D007T01      CD\n72  101.22229         1       C       D   5   4    0.20    0.04       uM D007T01      CD\n73   70.19044         1       C       D   2   1   25.00    5.00       uM D007T01      CD\n74   87.12788         1       C       D   1   4    0.20   25.00       uM D007T01      CD\n75   83.97836         1       C       D",
        "   3   5    0.04    1.00       uM D007T01      CD\n76   98.37566         1       C       D   4   3    1.00    0.20       uM D007T01      CD\n77   61.18750         1       C       D   2   1   25.00    5.00       uM D007T01      CD\n78   69.24510         1       C       D   1   1   25.00   25.00       uM D007T01      CD\n79   97.20391         1       C       D   2   4    0.20    5.00       uM D007T01      CD\n80   94.42469         1       C       D   4   4    0.20    0.20       uM D007T01      CD\n81   77.89553         1",
        "       C       D   1   2    5.00   25.00       uM D007T01      CD\n82   88.41961         1       C       D   2   3    1.00    5.00       uM D007T01      CD\n83   90.71373         1       C       D   5   5    0.04    0.04       uM D007T01      CD\n84   89.78236         1       C       D   6   2    5.00    0.00       uM D007T01      CD\n85  103.87442         1       C       D   3   6    0.00    1.00       uM D007T01      CD\n86  109.20529         1       C       D   6   3    1.00    0.00       uM D007T01      CD\n87 ",
        " 100.34979         1       C       D   6   6    0.00    0.00       uM D007T01      CD\n88   92.78147         1       C       D   6   4    0.20    0.00       uM D007T01      CD\n89   86.45931         1       C       D   5   6    0.00    0.04       uM D007T01      CD\n90   54.90276         1       C       D   6   1   25.00    0.00       uM D007T01      CD\n [ reached getOption(\"max.print\") -- omitted 342 rows ]\n",
        "> ",
        "syn_drug %>% filter(BlockID == \"CD\", Col = 6) %>% ",
        "+ ",
        "syn_drug %>% filter(BlockID == \"CD\", Col == 6)  ",
        "Error: `Col` (`Col = 6`) must not be named, do you need `==`?\n",
        "> ",
        "syn_drug %>% filter(BlockID == \"CD\" & Col == 6)  ",
        "    Response Replicate DrugRow DrugCol Col Row ConcRow ConcCol ConcUnit    line BlockID\n1  100.25148         1       C       D   6   2    5.00       0       uM D007T01      CD\n2   87.68309         1       C       D   6   2    5.00       0       uM D007T01      CD\n3   89.29101         1       C       D   6   6    0.00       0       uM D007T01      CD\n4   97.58110         1       C       D   6   5    0.04       0       uM D007T01      CD\n5   72.37890         1       C       D   6   1   25.00       0       uM D007T01",
        "      CD\n6   60.37068         1       C       D   6   1   25.00       0       uM D007T01      CD\n7   94.43397         1       C       D   6   5    0.04       0       uM D007T01      CD\n8   89.66758         1       C       D   6   3    1.00       0       uM D007T01      CD\n9   91.63767         1       C       D   6   3    1.00       0       uM D007T01      CD\n10  96.80841         1       C       D   6   5    0.04       0       uM D007T01      CD\n11 100.56106         1       C       D   6   4    0.20       0       uM",
        " D007T01      CD\n12  89.78236         1       C       D   6   2    5.00       0       uM D007T01      CD\n13 109.20529         1       C       D   6   3    1.00       0       uM D007T01      CD\n14 100.34979         1       C       D   6   6    0.00       0       uM D007T01      CD\n15  92.78147         1       C       D   6   4    0.20       0       uM D007T01      CD\n16  54.90276         1       C       D   6   1   25.00       0       uM D007T01      CD\n17 127.60047         1       C       D   6   6    0.00       0",
        "       uM D007T01      CD\n18 100.48005         1       C       D   6   4    0.20       0       uM D007T01      CD\n19 134.30337         1       C       D   6   2    5.00       0       uM D027T01      CD\n20  93.19144         1       C       D   6   2    5.00       0       uM D027T01      CD\n21  97.96723         1       C       D   6   6    0.00       0       uM D027T01      CD\n22 101.52864         1       C       D   6   5    0.04       0       uM D027T01      CD\n23  73.63246         1       C       D   6   1",
        "   25.00       0       uM D027T01      CD\n24  59.58740         1       C       D   6   1   25.00       0       uM D027T01      CD\n25  89.19062         1       C       D   6   5    0.04       0       uM D027T01      CD\n26 103.75177         1       C       D   6   3    1.00       0       uM D027T01      CD\n27  99.52782         1       C       D   6   3    1.00       0       uM D027T01      CD\n28 107.15311         1       C       D   6   5    0.04       0       uM D027T01      CD\n29 101.29548         1       C",
        "       D   6   4    0.20       0       uM D027T01      CD\n30  91.80689         1       C       D   6   2    5.00       0       uM D027T01      CD\n31 111.76019         1       C       D   6   3    1.00       0       uM D027T01      CD\n32  95.66730         1       C       D   6   6    0.00       0       uM D027T01      CD\n33 109.32151         1       C       D   6   4    0.20       0       uM D027T01      CD\n34  47.17628         1       C       D   6   1   25.00       0       uM D027T01      CD\n35 123.85344         1",
        "       C       D   6   6    0.00       0       uM D027T01      CD\n36  96.83901         1       C       D   6   4    0.20       0       uM D027T01      CD\n37  96.79696         2       C       D   6   2    5.00       0       uM D007T01      CD\n38  94.02306         2       C       D   6   2    5.00       0       uM D007T01      CD\n39 107.03097         2       C       D   6   6    0.00       0       uM D007T01      CD\n40  98.64319         2       C       D   6   5    0.04       0       uM D007T01      CD\n41  71.87834",
        "         2       C       D   6   1   25.00       0       uM D007T01      CD\n42  70.61358         2       C       D   6   1   25.00       0       uM D007T01      CD\n43  98.78478         2       C       D   6   5    0.04       0       uM D007T01      CD\n44  93.35396         2       C       D   6   3    1.00       0       uM D007T01      CD\n45 108.18286         2       C       D   6   3    1.00       0       uM D007T01      CD\n46 108.31464         2       C       D   6   5    0.04       0       uM D007T01      CD",
        "\n47  91.87693         2       C       D   6   4    0.20       0       uM D007T01      CD\n48  85.95378         2       C       D   6   2    5.00       0       uM D007T01      CD\n49 116.29667         2       C       D   6   3    1.00       0       uM D007T01      CD\n50 116.68049         2       C       D   6   6    0.00       0       uM D007T01      CD\n51  92.94667         2       C       D   6   4    0.20       0       uM D007T01      CD\n52  55.56115         2       C       D   6   1   25.00       0       uM",
        " D007T01      CD\n53 119.57940         2       C       D   6   6    0.00       0       uM D007T01      CD\n54  85.60672         2       C       D   6   4    0.20       0       uM D007T01      CD\n55  91.22113         2       C       D   6   2    5.00       0       uM D027T01      CD\n56  83.90001         2       C       D   6   2    5.00       0       uM D027T01      CD\n57 105.42908         2       C       D   6   6    0.00       0       uM D027T01      CD\n58 108.05008         2       C       D   6   5    0.04       0",
        "       uM D027T01      CD\n59  66.36351         2       C       D   6   1   25.00       0       uM D027T01      CD\n60  64.04598         2       C       D   6   1   25.00       0       uM D027T01      CD\n61  88.52781         2       C       D   6   5    0.04       0       uM D027T01      CD\n62 102.39888         2       C       D   6   3    1.00       0       uM D027T01      CD\n63 100.10501         2       C       D   6   3    1.00       0       uM D027T01      CD\n64 110.35085         2       C       D   6   5",
        "    0.04       0       uM D027T01      CD\n65 104.92668         2       C       D   6   4    0.20       0       uM D027T01      CD\n66  91.63274         2       C       D   6   2    5.00       0       uM D027T01      CD\n67 112.17512         2       C       D   6   3    1.00       0       uM D027T01      CD\n68 107.17089         2       C       D   6   6    0.00       0       uM D027T01      CD\n69  84.39487         2       C       D   6   4    0.20       0       uM D027T01      CD\n70  51.57269         2       C",
        "       D   6   1   25.00       0       uM D027T01      CD\n71 117.68847         2       C       D   6   6    0.00       0       uM D027T01      CD\n72  90.71067         2       C       D   6   4    0.20       0       uM D027T01      CD\n",
        "> ",
        "syn_drug %>% filter(BlockID == \"CD\" & Col == 6)  %>% View",
        "> ",
        "syn_drug <- ctg_ln %>%",
        "+ ",
        "    #filter(!drug %in% coi) %>%",
        "+ ",
        "    #filter(query != \"L11DM\") %>%",
        "+ ",
        "    #filter(combination == TRUE) %>%",
        "+ ",
        "    rename(rv = viability) %>%",
        "+ ",
        "    #setup the easy stuff",
        "+ ",
        "    dplyr::transmute(",
        "+ ",
        "      #BlockID = paste(query, drug, sep = \"_\"),",
        "+ ",
        "           Response = rv*100,",
        "+ ",
        "           Replicate = ifelse(date == \"180320\", 1, 2),",
        "+ ",
        "           DrugRow = DrugRow,",
        "+ ",
        "           DrugCol = DrugCol,",
        "+ ",
        "           #build matrix",
        "+ ",
        "           Col = Col,",
        "+ ",
        "           Row = Row,",
        "+ ",
        "           #define concentrations",
        "+ ",
        "           ConcRow = ifelse(Row == 6, 0, 25/(5^(as.numeric(Row)-1))), #assuming the initila concentration is 50",
        "+ ",
        "           ConcCol = ifelse(Col == 6, 0, 25/(5^(as.numeric(Col)-1))),",
        "+ ",
        "           ConcUnit = \"uM\",",
        "+ ",
        "      line = line, ",
        "+ ",
        "      BlockID = BlockID",
        "+ ",
        "      ",
        "+ ",
        "           ) #%>% mutate(BlockID = paste(query, drug, sep = \"_\"))",
        "> ",
        "syn_drug %>% filter(BlockID == \"CD\" & Col == 6)  %>% View",
        "> ",
        "syn_drug %>% View",
        "> ",
        "ctg_ln %>% View",
        "> ",
        "coi <- c(\"Staurosporine\")",
        "> ",
        "syn_drug <- ctg_ln %>%",
        "+ ",
        "    filter(!drug %in% coi) %>%",
        "+ ",
        "    #filter(query != \"L11DM\") %>%",
        "+ ",
        "    #filter(combination == TRUE) %>%",
        "+ ",
        "    rename(rv = viability) %>%",
        "+ ",
        "    #setup the easy stuff",
        "+ ",
        "    dplyr::transmute(",
        "+ ",
        "      #BlockID = paste(query, drug, sep = \"_\"),",
        "+ ",
        "           Response = rv*100,",
        "+ ",
        "           Replicate = ifelse(date == \"180320\", 1, 2),",
        "+ ",
        "           DrugRow = DrugRow,",
        "+ ",
        "           DrugCol = DrugCol,",
        "+ ",
        "           #build matrix",
        "+ ",
        "           Col = Col,",
        "+ ",
        "           Row = Row,",
        "+ ",
        "           #define concentrations",
        "+ ",
        "           ConcRow = ifelse(Row == 6, 0, 25/(5^(as.numeric(Row)-1))), #assuming the initila concentration is 50",
        "+ ",
        "           ConcCol = ifelse(Col == 6, 0, 25/(5^(as.numeric(Col)-1))),",
        "+ ",
        "           ConcUnit = \"uM\",",
        "+ ",
        "      line = line, ",
        "+ ",
        "      BlockID = BlockID",
        "+ ",
        "      ",
        "+ ",
        "           ) #%>% mutate(BlockID = paste(query, drug, sep = \"_\"))",
        "> ",
        "syn_drug %>% dim()",
        "[1] 1456   11\n",
        "> ",
        "syn_drug %>% View",
        "> ",
        "syn_drug %>% filter(is.na(BlockID))",
        "     Response Replicate DrugRow DrugCol  Col  Row ConcRow ConcCol ConcUnit    line BlockID\n1   106.94366         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n2   108.00061         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n3   100.68318         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n4   122.13499         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n5   104.28552         1    <NA>    <NA> <NA> <NA>      NA",
        "      NA       uM D007T01    <NA>\n6   101.77408         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n7    98.70519         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n8   107.11280         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n9    99.55807         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n10   88.78473         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n11  102.40399         1",
        "    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n12   92.18745         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n13  101.86064         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n14   99.28686         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n15   95.45730         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n16  100.39523         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01",
        "    <NA>\n17  103.11219         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n18   97.43015         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n19  103.93624         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n20   97.45179         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n21   93.56118         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n22   88.46160         1    <NA>    <NA> <NA> <NA>",
        "      NA      NA       uM D007T01    <NA>\n23   94.60897         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n24   96.59176         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n25   93.33980         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n26   94.64784         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n27  103.39017         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n28   96.93102         1",
        "    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n29   98.68132         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n30  100.35931         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n31  101.57902         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n32   93.65884         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n33   99.64069         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01",
        "    <NA>\n34  110.27347         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n35  105.11798         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n36   94.91015         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n37   82.75108         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n38  105.89233         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n39  107.34392         1    <NA>    <NA> <NA> <NA>",
        "      NA      NA       uM D007T01    <NA>\n40  130.48614         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n41  137.13498         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n42  122.04628         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n43  115.26848         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n44  106.69945         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n45  136.18434         1",
        "    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n46   94.59992         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n47  104.46168         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n48  109.13654         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n49  103.07592         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n50  121.37245         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01",
        "    <NA>\n51   83.50597         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n52   90.22455         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n53   97.36068         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n54   86.71838         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n55   99.10924         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n56   94.97054         1    <NA>    <NA> <NA> <NA>",
        "      NA      NA       uM D027T01    <NA>\n57   95.81107         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n58   87.60434         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n59  101.77183         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n60   98.86146         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n61   97.24250         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n62  100.89076         1",
        "    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n63   81.56880         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n64   95.52177         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n65   90.32464         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n66   91.19877         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n67  106.48557         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01",
        "    <NA>\n68  106.86993         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n69  103.22352         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n70   96.33759         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n71  105.27903         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n72   94.47879         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n73  101.82244         1    <NA>    <NA> <NA> <NA>",
        "      NA      NA       uM D027T01    <NA>\n74  102.05966         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n75   95.65838         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n76   96.69260         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n77   86.10706         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n78  109.08745         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n79  104.62571         1",
        "    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n80  132.22367         1    <NA>    <NA> <NA> <NA>      NA      NA       uM D027T01    <NA>\n81  102.42000         2    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n82  115.58283         2    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n83  115.21143         2    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n84  112.71313         2    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01",
        "    <NA>\n85   97.72772         2    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n86  106.57418         2    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n87   98.71524         2    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n88  103.24571         2    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n89   98.58092         2    <NA>    <NA> <NA> <NA>      NA      NA       uM D007T01    <NA>\n90   93.16204         2    <NA>    <NA> <NA> <NA>",
        "      NA      NA       uM D007T01    <NA>\n [ reached getOption(\"max.print\") -- omitted 70 rows ]\n",
        "> ",
        "syn_drug %>% filter(is.na(BlockID)) %>%",
        "+ ",
        "                          group_by(DrugRow, Row, Replicate, line, DrugCol, Col, ConcRow, ConcCol, ConcUnit) %>% ",
        "+ ",
        "                          summarise(Response = mean(Response, na.rm = TRUE))",
        "[38;5;246m# A tibble: 4 x 10[39m\n[38;5;246m# Groups:   DrugRow, Row, Replicate, line, DrugCol, Col, ConcRow, ConcCol [?][39m\n  DrugRow Row   Replicate line    DrugCol Col   ConcRow ConcCol ConcUnit Response\n  [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m     [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<dbl>[39m[23m   [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<chr>[39m[23m       [3m[38;5;246m<dbl>[39m[23m\n",
        "[38;5;250m1[39m [31mNA[39m      [31mNA[39m           1. D007T01 [31mNA[39m      [31mNA[39m         [31mNA[39m      [31mNA[39m uM           101.\n[38;5;250m2[39m [31mNA[39m      [31mNA[39m           1. D027T01 [31mNA[39m      [31mNA[39m         [31mNA[39m      [31mNA[39m uM           102.\n[38;5;250m3[39m [31mNA[39m      [31mNA[39m           2. D007T01 [31mNA[39m      [31mNA[39m         [31mNA[39m      [31mNA[39m uM           101.\n[38;5;250m4[39m [31mNA[39m      [31mNA[39m           2. D027T01 [31mNA[39m      [31mNA[39m         [31mNA[39m      [31mNA[39m uM           103.\n",
        "> ",
        "coi <- c(\"Staurosporine\", \"DMSO\")",
        "> ",
        "syn_drug <- ctg_ln %>%",
        "+ ",
        "    filter(!drug %in% coi) %>%",
        "+ ",
        "    #filter(query != \"L11DM\") %>%",
        "+ ",
        "    #filter(combination == TRUE) %>%",
        "+ ",
        "    rename(rv = viability) %>%",
        "+ ",
        "    #setup the easy stuff",
        "+ ",
        "    dplyr::transmute(",
        "+ ",
        "      #BlockID = paste(query, drug, sep = \"_\"),",
        "+ ",
        "           Response = rv*100,",
        "+ ",
        "           Replicate = ifelse(date == \"180320\", 1, 2),",
        "+ ",
        "           DrugRow = DrugRow,",
        "+ ",
        "           DrugCol = DrugCol,",
        "+ ",
        "           #build matrix",
        "+ ",
        "           Col = Col,",
        "+ ",
        "           Row = Row,",
        "+ ",
        "           #define concentrations",
        "+ ",
        "           ConcRow = ifelse(Row == 6, 0, 25/(5^(as.numeric(Row)-1))), #assuming the initila concentration is 50",
        "+ ",
        "           ConcCol = ifelse(Col == 6, 0, 25/(5^(as.numeric(Col)-1))),",
        "+ ",
        "           ConcUnit = \"uM\",",
        "+ ",
        "      line = line, ",
        "+ ",
        "      BlockID = BlockID",
        "+ ",
        "      ",
        "+ ",
        "           ) #%>% mutate(BlockID = paste(query, drug, sep = \"_\"))",
        "> ",
        "tidy_synergy = function(df, me){ lapply(as.list(me), function(m, f = df){",
        "+ ",
        "  #hacky way of ignoring cases in which the synergy scores could not be calculated",
        "+ ",
        "  return(tryCatch(f %>% ",
        "+ ",
        "      ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "      #PlotDoseResponse() %>%",
        "+ ",
        "      CalculateSynergy(method = m, correction = TRUE) %>%",
        "+ ",
        "    tibble(BlockID = .$drug.pairs %>% simplify() %>% .[4],",
        "+ ",
        "           method = .$method,",
        "+ ",
        "           score_average = .$scores %>% .[[1]] %>% .[-1,-1] %>% simplify() %>% mean(),",
        "+ ",
        "           score_sd = .$scores %>% .[[1]] %>% .[-1,-1] %>% simplify() %>% sd()) %>%",
        "+ ",
        "    select(BlockID, method, score_average, score_sd) %>% distinct(), ",
        "+ ",
        "    error=function(e) NULL))}",
        "+ ",
        ") %>% bind_rows()",
        "+ ",
        "  #PlotSynergy(type = \"all\")",
        "+ ",
        "  }",
        "> ",
        "collab_syn <- syn_drug %>%  group_by(line, Replicate , BlockID) %>% ",
        "+ ",
        "  do(tidy_synergy(df = ., me = c(\"ZIP\", \"HSA\", \"Bliss\", \"Loewe\"))) %>%",
        "+ ",
        "  ungroup() %>%",
        "+ ",
        "  #complete the df for scores that could not be calculated",
        "+ ",
        "  mutate(method = as.factor(method),",
        "+ ",
        "         line = as.factor(line)) %>% ",
        "+ ",
        "  complete(BlockID, method, Replicate, line) %>%",
        "+ ",
        "  mutate(score_average = ifelse(is.nan(score_average), NA, score_average))",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Aggregation function missing: defaulting to length\n",
        "Error in mutate_impl(.data, dots) : \n  Evaluation error: object 'method' not found.\n",
        "> ",
        "knitr::opts_chunk$set(echo = TRUE)",
        "> ",
        "knitr::opts_chunk$set(fig.width=12, fig.height=8) ",
        "> ",
        "# Set some global knitr options",
        "> ",
        "library(\"knitr\")",
        "> ",
        "opts_chunk$set(tidy=TRUE, tidy.opts=list(blank=FALSE, width.cutoff=60), cache=TRUE, messages=FALSE)",
        "> ",
        "syn_mat %>% filter(line == \"07\", BlockID == boi, Replicate == 1) %>%",
        "+ ",
        "  ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "  CalculateSynergy(method = \"ZIP\", correction = TRUE) %>%",
        "+ ",
        "  PlotSynergy(type = \"all\", save.file = FALSE)",
        "> ",
        "boi = c(\"AB\")",
        "> ",
        "moi = \"ZIP\"",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>%",
        "+ ",
        "  ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "  CalculateSynergy(method = \"ZIP\", correction = TRUE) %>%",
        "+ ",
        "  PlotSynergy(type = \"all\", save.file = FALSE)",
        "Aggregation function missing: defaulting to length\n",
        "Error in dimnames(x) <- dn : \n  length of 'dimnames' [2] not equal to array extent\n",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>%",
        "+ ",
        "  ReshapeData(., data.type = \"viability\")",
        "Aggregation function missing: defaulting to length\n",
        "Error in dimnames(x) <- dn : \n  length of 'dimnames' [2] not equal to array extent\n",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1)",
        "     Response Replicate DrugRow DrugCol Col Row ConcRow ConcCol ConcUnit    line BlockID\n1    37.75998         1       A       B   2   2    5.00    5.00       uM D007T01      AB\n2    48.09578         1       A       B   2   3    1.00    5.00       uM D007T01      AB\n3    42.14335         1       A       B   6   3    1.00    0.00       uM D007T01      AB\n4    45.73927         1       A       B   4   4    0.20    0.20       uM D007T01      AB\n5    61.85853         1       A       B   3   5    0.04    1.00       uM",
        " D007T01      AB\n6    36.96365         1       A       B   4   2    5.00    0.20       uM D007T01      AB\n7    74.18969         1       A       B   6   5    0.04    0.00       uM D007T01      AB\n8    49.97118         1       A       B   5   5    0.04    0.04       uM D007T01      AB\n9    55.38844         1       A       B   2   4    0.20    5.00       uM D007T01      AB\n10   40.35065         1       A       B   2   3    1.00    5.00       uM D007T01      AB\n11   39.70929         1       A       B   5   1   25.00",
        "    0.04       uM D007T01      AB\n12   42.08692         1       A       B   5   2    5.00    0.04       uM D007T01      AB\n13   44.00776         1       A       B   2   2    5.00    5.00       uM D007T01      AB\n14   71.70414         1       A       B   1   5    0.04   25.00       uM D007T01      AB\n15   56.36729         1       A       B   4   5    0.04    0.20       uM D007T01      AB\n16   55.63180         1       A       B   2   4    0.20    5.00       uM D007T01      AB\n17   46.18092         1       A       B",
        "   4   4    0.20    0.20       uM D007T01      AB\n18   37.66392         1       A       B   5   1   25.00    0.04       uM D007T01      AB\n19   97.69894         1       A       B   4   6    0.00    0.20       uM D007T01      AB\n20   42.05164         1       A       B   5   4    0.20    0.04       uM D007T01      AB\n21   44.02545         1       A       B   3   4    0.20    1.00       uM D007T01      AB\n22   45.88907         1       A       B   3   4    0.20    1.00       uM D007T01      AB\n23   95.10522         1",
        "       A       B   1   6    0.00   25.00       uM D007T01      AB\n24   71.55855         1       A       B   1   5    0.04   25.00       uM D007T01      AB\n25   38.64702         1       A       B   5   3    1.00    0.04       uM D007T01      AB\n26   36.27154         1       A       B   2   3    1.00    5.00       uM D007T01      AB\n27   41.04513         1       A       B   6   4    0.20    0.00       uM D007T01      AB\n28   58.89249         1       A       B   5   5    0.04    0.04       uM D007T01      AB\n29 ",
        "  43.27260         1       A       B   2   4    0.20    5.00       uM D007T01      AB\n30   53.25461         1       A       B   3   5    0.04    1.00       uM D007T01      AB\n31   41.16864         1       A       B   3   3    1.00    1.00       uM D007T01      AB\n32   44.67947         1       A       B   1   3    1.00   25.00       uM D007T01      AB\n33   99.45828         1       A       B   3   6    0.00    1.00       uM D007T01      AB\n34   38.55364         1       A       B   6   3    1.00    0.00       uM",
        " D007T01      AB\n35   63.61102         1       A       B   2   5    0.04    5.00       uM D007T01      AB\n36   42.49481         1       A       B   6   4    0.20    0.00       uM D007T01      AB\n37   42.70717         1       A       B   3   2    5.00    1.00       uM D007T01      AB\n38   42.39347         1       A       B   6   1   25.00    0.00       uM D007T01      AB\n39   40.24766         1       A       B   3   2    5.00    1.00       uM D007T01      AB\n40   93.49950         1       A       B   2   6    0.00",
        "    5.00       uM D007T01      AB\n41   99.72143         1       A       B   6   6    0.00    0.00       uM D007T01      AB\n42   31.81748         1       A       B   2   1   25.00    5.00       uM D007T01      AB\n43   90.71777         1       A       B   4   6    0.00    0.20       uM D007T01      AB\n44   31.70457         1       A       B   6   2    5.00    0.00       uM D007T01      AB\n45   43.17246         1       A       B   1   3    1.00   25.00       uM D007T01      AB\n46   33.82209         1       A       B",
        "   3   1   25.00    1.00       uM D007T01      AB\n47   38.15239         1       A       B   1   2    5.00   25.00       uM D007T01      AB\n48   93.51457         1       A       B   4   6    0.00    0.20       uM D007T01      AB\n49   56.53907         1       A       B   4   5    0.04    0.20       uM D007T01      AB\n50   91.64104         1       A       B   6   6    0.00    0.00       uM D007T01      AB\n51   40.12180         1       A       B   6   1   25.00    0.00       uM D007T01      AB\n52   37.32219         1",
        "       A       B   3   3    1.00    1.00       uM D007T01      AB\n53   46.58489         1       A       B   1   3    1.00   25.00       uM D007T01      AB\n54   56.76725         1       A       B   2   5    0.04    5.00       uM D007T01      AB\n55   51.76403         1       A       B   6   5    0.04    0.00       uM D007T01      AB\n56   71.92731         1       A       B   1   5    0.04   25.00       uM D007T01      AB\n57   37.80522         1       A       B   5   1   25.00    0.04       uM D007T01      AB\n58 ",
        "  59.33969         1       A       B   2   5    0.04    5.00       uM D007T01      AB\n59   38.92044         1       A       B   4   4    0.20    0.20       uM D007T01      AB\n60   35.85978         1       A       B   1   2    5.00   25.00       uM D007T01      AB\n61   44.04372         1       A       B   4   3    1.00    0.20       uM D007T01      AB\n62   94.18607         1       A       B   6   6    0.00    0.00       uM D007T01      AB\n63   50.05307         1       A       B   5   5    0.04    0.04       uM",
        " D007T01      AB\n64   37.08339         1       A       B   5   2    5.00    0.04       uM D007T01      AB\n65   53.04579         1       A       B   4   5    0.04    0.20       uM D007T01      AB\n66   91.62279         1       A       B   1   6    0.00   25.00       uM D007T01      AB\n67   42.09863         1       A       B   5   4    0.20    0.04       uM D007T01      AB\n68   92.83844         1       A       B   5   6    0.00    0.04       uM D007T01      AB\n69   34.39723         1       A       B   6   1   25.00",
        "    0.00       uM D007T01      AB\n70   35.60420         1       A       B   4   1   25.00    0.20       uM D007T01      AB\n71   41.40390         1       A       B   4   3    1.00    0.20       uM D007T01      AB\n72   34.90785         1       A       B   6   4    0.20    0.00       uM D007T01      AB\n73   32.00122         1       A       B   3   2    5.00    1.00       uM D007T01      AB\n74   30.45921         1       A       B   1   1   25.00   25.00       uM D007T01      AB\n75   87.83909         1       A       B",
        "   2   6    0.00    5.00       uM D007T01      AB\n76   93.23332         1       A       B   3   6    0.00    1.00       uM D007T01      AB\n77   35.36459         1       A       B   1   1   25.00   25.00       uM D007T01      AB\n78   52.28361         1       A       B   1   4    0.20   25.00       uM D007T01      AB\n79   35.78743         1       A       B   4   2    5.00    0.20       uM D007T01      AB\n80   68.91407         1       A       B   1   4    0.20   25.00       uM D007T01      AB\n81   40.63209         1",
        "       A       B   5   4    0.20    0.04       uM D007T01      AB\n82  108.79730         1       A       B   5   6    0.00    0.04       uM D007T01      AB\n83   24.70318         1       A       B   4   3    1.00    0.20       uM D007T01      AB\n84   38.60731         1       A       B   6   5    0.04    0.00       uM D007T01      AB\n85   28.21308         1       A       B   5   3    1.00    0.04       uM D007T01      AB\n86   95.09808         1       A       B   3   6    0.00    1.00       uM D007T01      AB\n87 ",
        "  34.25585         1       A       B   4   1   25.00    0.20       uM D007T01      AB\n88   66.56474         1       A       B   1   4    0.20   25.00       uM D007T01      AB\n89   49.99691         1       A       B   1   2    5.00   25.00       uM D007T01      AB\n90   25.94101         1       A       B   3   3    1.00    1.00       uM D007T01      AB\n [ reached getOption(\"max.print\") -- omitted 18 rows ]\n",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>% View",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>% group_by(Replicate, Col, Row, line, BlockID) %>% summarise(Response = mean(Response))",
        "[38;5;246m# A tibble: 36 x 6[39m\n[38;5;246m# Groups:   Replicate, Col, Row, line [?][39m\n   Replicate Col   Row   line    BlockID Response\n       [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<chr>[39m[23m [3m[38;5;246m<chr>[39m[23m [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m      [3m[38;5;246m<dbl>[39m[23m\n[38;5;250m 1[39m        1. 1     1     D007T01 AB          31.6\n[38;5;250m 2[39m        1. 1     2     D007T01 AB          41.3\n[38;5;250m 3[39m        1. 1     3     D007T01 AB          44.8\n",
        "[38;5;250m 4[39m        1. 1     4     D007T01 AB          62.6\n[38;5;250m 5[39m        1. 1     5     D007T01 AB          71.7\n[38;5;250m 6[39m        1. 1     6     D007T01 AB          94.5\n[38;5;250m 7[39m        1. 2     1     D007T01 AB          39.6\n[38;5;250m 8[39m        1. 2     2     D007T01 AB          37.5\n[38;5;250m 9[39m        1. 2     3     D007T01 AB          41.6\n[38;5;250m10[39m        1. 2     4     D007T01 AB          51.4\n[38;5;246m# ... with 26 more rows[39m\n",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>% group_by(Replicate, Col, Row, line, BlockID, DrugRow, DrugCol, ConcRow, ConcCol, ConcUnit) %>% summarise(Response = mean(Response))",
        "[38;5;246m# A tibble: 36 x 11[39m\n[38;5;246m# Groups:   Replicate, Col, Row, line, BlockID, DrugRow, DrugCol, ConcRow, ConcCol [?][39m\n   Replicate Col   Row   line    BlockID DrugRow DrugCol ConcRow ConcCol ConcUnit Response\n       [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<chr>[39m[23m [3m[38;5;246m<chr>[39m[23m [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m   [3m[38;5;246m<chr>[39m[23m     [3m[38;5;246m<dbl>[39m[23m   [3m[38;5;246m<dbl>[39m[23m [3m[38;5;246m<chr>[39m[23m       [3m[38;5;246m<dbl>[39m[23m\n",
        "[38;5;250m 1[39m        1. 1     1     D007T01 AB      A       B       25.0        25. uM           31.6\n[38;5;250m 2[39m        1. 1     2     D007T01 AB      A       B        5.00       25. uM           41.3\n[38;5;250m 3[39m        1. 1     3     D007T01 AB      A       B        1.00       25. uM           44.8\n[38;5;250m 4[39m        1. 1     4     D007T01 AB      A       B        0.200      25. uM           62.6\n[38;5;250m 5[39m        1. 1     5     D007T01 AB      A       B        0.040[4m0[24m     25. uM           71.7\n",
        "[38;5;250m 6[39m        1. 1     6     D007T01 AB      A       B        0.         25. uM           94.5\n[38;5;250m 7[39m        1. 2     1     D007T01 AB      A       B       25.0         5. uM           39.6\n[38;5;250m 8[39m        1. 2     2     D007T01 AB      A       B        5.00        5. uM           37.5\n[38;5;250m 9[39m        1. 2     3     D007T01 AB      A       B        1.00        5. uM           41.6\n[38;5;250m10[39m        1. 2     4     D007T01 AB      A       B        0.200       5. uM           51.4\n",
        "[38;5;246m# ... with 26 more rows[39m\n",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>% group_by(Replicate, Col, Row, line, BlockID, DrugRow, DrugCol, ConcRow, ConcCol, ConcUnit) %>% summarise(Response = mean(Response)) %>%",
        "+ ",
        "  ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "  CalculateSynergy(method = \"ZIP\", correction = TRUE) %>%",
        "+ ",
        "  PlotSynergy(type = \"all\", save.file = FALSE)",
        "Error in plot.new() : \n  QuartzBitmap_Output - unable to open file '/Users/rindtorf/tas/.Rproj.user/shared/notebooks/DF9086E2-01_inspect_dataset/1/s/c1qcq8eaa5p8g_t/_rs_chunk_plot_001.png'\n",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>% group_by(Replicate, Col, Row, line, BlockID, DrugRow, DrugCol, ConcRow, ConcCol, ConcUnit) %>% summarise(Response = mean(Response)) %>%",
        "+ ",
        "    ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "    CalculateSynergy(method = \"ZIP\", correction = TRUE) %>%",
        "+ ",
        "    PlotSynergy(type = \"all\", save.file = FALSE)",
        "Error in plot.new() : \n  QuartzBitmap_Output - unable to open file '/Users/rindtorf/tas/.Rproj.user/shared/notebooks/DF9086E2-01_inspect_dataset/1/s/c1qcq8eaa5p8g_t/_rs_chunk_plot_001.png'\n",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>% group_by(Replicate, Col, Row, line, BlockID, DrugRow, DrugCol, ConcRow, ConcCol, ConcUnit) %>% summarise(Response = mean(Response)) %>%",
        "+ ",
        "    ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "    CalculateSynergy(method = \"ZIP\", correction = TRUE) %>%",
        "+ ",
        "    PlotSynergy(type = \"all\", save.file = FALSE)",
        "Error in plot.new() : \n  QuartzBitmap_Output - unable to open file '/Users/rindtorf/tas/.Rproj.user/shared/notebooks/DF9086E2-01_inspect_dataset/1/s/c1qcq8eaa5p8g_t/_rs_chunk_plot_001.png'\n",
        "> ",
        "syn_mat %>% filter(line == \"07\", BlockID == boi, Replicate == 1) %>%",
        "+ ",
        "  ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "  CalculateSynergy(method = \"ZIP\", correction = TRUE) %>%",
        "+ ",
        "  PlotSynergy(type = \"all\", save.file = FALSE)",
        "Error in dim(ordered) <- ns : \n  dims [product 1] do not match the length of object [0]\n",
        "> ",
        "boi = c(\"TAS-102_Bosutinib\")",
        "> ",
        "moi = \"ZIP\"",
        "> ",
        "syn_mat %>% filter(line == \"07\", BlockID == boi, Replicate == 1) %>%",
        "+ ",
        "  ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "  CalculateSynergy(method = \"ZIP\", correction = TRUE) %>%",
        "+ ",
        "  PlotSynergy(type = \"all\", save.file = FALSE)",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>% group_by(Replicate, Col, Row, line, BlockID, DrugRow, DrugCol, ConcRow, ConcCol, ConcUnit) %>% summarise(Response = mean(Response)) %>%",
        "+ ",
        "  ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "  CalculateSynergy(method = \"ZIP\", correction = TRUE) %>%",
        "+ ",
        "  PlotSynergy(type = \"all\", save.file = FALSE)",
        "Error in dim(ordered) <- ns : \n  dims [product 1] do not match the length of object [0]\n",
        "> ",
        "boi = c(\"AB\")",
        "> ",
        "moi = \"ZIP\"",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>% group_by(Replicate, Col, Row, line, BlockID, DrugRow, DrugCol, ConcRow, ConcCol, ConcUnit) %>% summarise(Response = mean(Response)) %>%",
        "+ ",
        "  ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "  CalculateSynergy(method = \"ZIP\", correction = TRUE) %>%",
        "+ ",
        "  PlotSynergy(type = \"all\", save.file = FALSE)",
        "Error in plot.new() : \n  QuartzBitmap_Output - unable to open file '/Users/rindtorf/tas/.Rproj.user/shared/notebooks/DF9086E2-01_inspect_dataset/1/s/c1qcq8eaa5p8g_t/_rs_chunk_plot_001.png'\n",
        "> ",
        "syn_drug %>% filter(line == \"D007T01\", BlockID == boi, Replicate == 1) %>% group_by(Replicate, Col, Row, line, BlockID, DrugRow, DrugCol, ConcRow, ConcCol, ConcUnit) %>% summarise(Response = mean(Response)) %>%",
        "+ ",
        "    ReshapeData(., data.type = \"viability\") %>%",
        "+ ",
        "    CalculateSynergy(method = \"ZIP\", correction = TRUE) %>%",
        "+ ",
        "    PlotSynergy(type = \"all\", save.file = FALSE)",
        "Error in plot.new() : \n  QuartzBitmap_Output - unable to open file '/Users/rindtorf/tas/.Rproj.user/shared/notebooks/DF9086E2-01_inspect_dataset/1/s/c1qcq8eaa5p8g_t/_rs_chunk_plot_001.png'\n",
        "\nRestarting R session...\n\n"
    ],
    "type" : [
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        2
    ]
}